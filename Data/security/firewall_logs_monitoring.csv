mot_cl√©,post_et_reponses
firewall logs monitoring,"i will start with i must be a moron, because i even have a guide and cant seem to get my logs across the tunnel. the basic plan is to move from an onsite siem device at each site to a centralized system. i am doing packet captures on the interfaces and the traffic is not even being attempted. what am i missing? i have my nat, static route and can ping my target from the internal subnet. here is a base line i tested but i have seen better progress with my goal from the external interface at a site with lite sdwan. || idk ftd, but what youre likely missing is the source address for syslog traffic. im guessing your tunnels routingpolicytraffic selectorsetc dont cover the default syslog source address. figure out how to either change the source address or source interface or configure your tunnel to cover the address. or both || hi, ill be asking some stupid questions. could there be a firewall rule thats not allowing the traffic to flow? icmp or ping might be allow but syslog not? || i had the same issue , got tac involved and it never got resolved i ended up using rsyslog on a ubuntu box to just send it to my siem across a tunnel"
firewall logs monitoring,"hi everyone, i work for a software company and our company has been pushing us to go all in on ai this year. weve had several meetings and there have been some super neat projects that have been shown by various development teams or things of that nature but i feel like i cant find anything useful that we can point to other than stuff weve been using for years like our ncm or firewall related logs alerting us proactively or what not. today we were told that if we arent using ai that we are being left behind and i feel super discouraged because we get asked by our management that we need to show that we are using ai in our daily tasks but yet other than what i mentioned above i cant point to anything. ive been in it for 20 years and been a network engineer for 11 of those and its not that im resistant to change but i dont know where to really start the network is the heart of everything that everyone uses. how are you using ai in your daily work just looking for examples or maybe think outside of the box i feel like im not seeing the big picture or that one thing of here is something cool you can do and implement thanks for reading. || hey chat gpt, here is my private network configuration data, please dont share it with anyone else || i use ai to write emails back to management. technically, it has no real value beyond barfing out error prone snippets. || i dont."
firewall logs monitoring,"i have a customer who we did a network design for just over a year ago. we talked them through all the pros and cons as part of the design process and they selected to terminate all the vlans onto their cisco switches and then just have a layer 3 transit up to the firewall. this firewall was easy to spec as it was essentially just a case of how big are your internet pipes, how much might they grow over the next 56 years. boom there is a firewall. we are now 12 months layer and they are saying we want to terminate all the vlans and they have a lot, and want more onto the firewall. i agree this is a superior and potentially more secure design but i suspect if we do this it will just overload the firewall as it just wasnt speced for that use case. the customer, and rightfully so, is saying give us some figures to backup that statement. that got me thinking.... what is the best way to do this? my initial thought process is put netflow in on the core switch and look at the traffic levels between the various vlans. we could also monitor the traffic levels on the svis its a cisco core switch and see what traffic levels they get. currently the customer is using prtg but is there some other tools that could give us better reporting? but what does reddit think? what have i missed? what else could i consider? ||  || you dont say anything about the fw capabilities. its very difficult to answer the question in the title if you dont specify the firewall itself. and i do agree with other comments it all depends what you want to do with the traffic when it hits the firewall. do you just want to do regular l4 filtering or are they going with something like l7 filtering appid with pa, ssl decryption? are you going to employ security profiles to filter ew traffic as well? is the firewall doing any ipsec tunneling or ravpn? basically, its not just the amount of traffic, its also what youre going to do with it. newer fortigates and pa series starting with 400 series are small beasts and can handle a lot of abuse of course, the more you need, the higher you go on the ladder when speccing the fw as well. as for routing, i disagree with some of the comments unless youre talking about very specific routing usually reserved for datacenters, firewalls are more than capable of doing it, at least major vendors in the field are. if youre talking about just intervlan routing, then double that. ive been in networking field for past 20 years, last 10 years mostly security engineering firewalls and unless im working with a very specific type of a company that absolutely needs to have line speed for intervlan traffic, all vlans are terminated on the firewall, no exception im done with the days of 2010 years ago when i was trying to figure out which acl on a switch is blocking something. || group networks inside a vrf and use the firewall as the gateway. this reduces the number of vlans on the firewall and allows east west between like networks with minimal security concern."
firewall logs monitoring,"i currently work as a net admin for a large health care organization, 4 years experience. i am paid 72kyr no benefits but good teammates and manager, get to touch a lot and learn a lot palo alto firewall, nac, routeswitch, sdwan, solarwinds, linux servers, certificates, active directory, data center, cloud, voip, etc. got an offer for a network engineer role at a large f500 company. after the interview i learned that this network team doesnt touch firewall, nac, monitoring, servers, ad etc, its purely onsite traditional routeswitchwireless. the pay is 95k100k with full benefits. wondering what i should value more at this point in my career. if i stay at the current organization i will learn a lot more, have the chance to work my way up to engineer within the next 23 years with a good team i trust. on the other hand if i jump ship to the new f500, i would have a very prestigious title at a very prestigious company and make a ton more money. my only concern is im afraid i may be siloed into traditional networking when ive been trying to inch my way more into cloud, and network security. what would you do? what is more valuable? money or experience? edit i also want to mention job stability because thats important in this economy. the current organization is recession proof in a way, i have full job security here, never any layoffs in 80 years, whereas the f500 is in an economy dependent industry that is known for mass layoffs. should this should be taken into consideration due to the current state of the economy? || why would you wait 23 years for a title bump to network engineer when youre already doing network engineer things. if you are making changes to firewalls andor switches then youre already a network engineer. shouldnt even been thinking about this, take the new job and work on some cloud certs and use it as leverage for an even higher paying cloud architect job in the future. edit if you really like your current job and team ask them to match the offer benefits title now. || in a perfect world youd get it all, right? but i can say i notice the benefits of money everyday, and of experience once in awhile. || make the switch and take the money. keep learning and building your skill set. once you feel things are stagnating then make another switch. education is important but youre working for money."
firewall logs monitoring,"problem experiencing a long failover delay like 510 minutes when routing traffic on pa410 to use verizon 5g path. customer has the following palo alto pa410 ver 11.0.3h5. primary isp path through a verizon circuit resold through xtel. 100 mbps x 100 mbps secondary isp path through a verizon 5g router. the building is awful for connectivity. basically verizon is the only provider in the building, and the customer has a circuit through xtel who resells verizon. the circuit is ok, most of the time, but there is no available land based backup available. as a kind of trial, we installed a verizon 5g router, connected that to the firewall, and are using it as isp2. it is technically a doublenat situation as the inside of the 5g router has a private ip. it is configured with a static public ip from verizon, but that happens on the 5g interface. when we manually route traffic through the verizon 5g path, traffic takes like 510 minutes to finally start passing. once its passing, it seems like everything is working normally. users get internet, i can reach the firewall on the outside interface, etc. to test the 5g router, the customer walked into the room and plugged in their laptop. immediately they got an ip address and had internet. we do palo alto dualisp all the time. were very confident that the firewall configuration is correct. what im less confident about is the pa410. weve stopped selling them to customers because they are very sluggish on the gui, they have limited logging, take forever during updates, etc. it feels like a pa220 all over again. ive opened a case with palo, but it seemed like they wanted to repeatedly review techsupport files following a failover test. ill be honest, i was buried two weeks ago when i opened the case and i didnt have time to properly follow up. weve had a case where a pa410 failed to boot after an upgrade so im especially leary to upgrade the pa410 because its not ha and its a site that i dont have tech hands readily available. mainly im wondering if anybody else has experienced super slow failover with pa410. || the 410 is a very entry firewall, with no or little logging. its mainly aimed for sdwan edge deployment. we deploy at our spoke sites 440s and never had any issues. have you followed this this is the guide we use for dual isp at remote sites. just make sure you tweak your monitor profile so its quicker to failover. || ecmp should be enabled. static default routes to both isps with ping monitors to your next hop within the static route. set pbf policies for both isps to get to the respective gateway. if you want to use both isps at the same time youll want your default routes with the same ad and metric and to look at additional pbf policies."
firewall logs monitoring,"hey everyone, im running a fortigate 200e with multiple vdoms. one specific vdom keeps flapping i get alarmresolved notifications constantly, but the firewall itself never goes fully down. interestingly, the flapping only stops when a device is physically connected to the port that vdoms vlans are on. there are no linkmonitor or performance sla configs on this vdom. all vlan interfaces are subinterfaces. no other vdoms behave this way. has anyone run into this behavior before? is there a way to keep the vdom stable without plugging in a dummy device? open to cli tweaks or hardware workarounds. || could you elaborate on what you exactly mean by flapping? first time ever hearing about a vdom that flaps.. what happens exactly when it flaps and what are the notifications you get? || i havent seen that before and it sounds like an odd use case but what if you throw a loopback interface in the vdom and use that as your monitoring endpoint? a lot is probably going to depend on how exactly your monitoring system is connecting and what your touchpoint is i.e. the internal vlan interface"
firewall logs monitoring,"hi there! were currently moving our office to a new building and want to start having a firewall there due to growth in staff and plans for getting tisax certified. were having round about 50 employees. a firewall for us should provide at least segmentation access control enhanced logging and monitoring ideally with built in reporting idsips threat protection vpn with entraid what would be good documented in sense of configuration for a nonfirewall expert and reasonable priced options? || in sense of configuration for a nonfirewall expert nope. chance of success zero. i just read an overview of tisax and i dont see how you can successfully achieve the levels of security maturity to receive that certification as an organization without a network security professional or three on staff, or the engagement of outside professional assistance. youre going to need more than just a firewall, youre probably going to need dataloss prevention, and secure document storage and all kinds of stuff that will require a fairly constant stream of care feeding. its possible im over thinking it as ive only read a single ai summary, but thats my thoughts on it. || generally non experts should find a trusted msp or consultant to handle this for them. its very important to find a good msp. ie. dont go with the one i used to work for. || none. and youre going to need more than just a firewall. best to hire a staff msp to meet those."
firewall logs monitoring,"im not super techie but i can get by or figure things out most of the time. i needed recommendations for a reasonably priced gateway for use in public settings like an rv park. can someone please recommend a good brandoption? i dont want to use nomadix. i dont need it to be super fancy, but simply set it up to require a password for guest wifi access, be able to isolate each user from one another, and a firewall to help protect our side of things. if anyone can recommend a good brandappliance i would appreciate it. probably would need to support 40 to 80 devices logged on at a time. || ive seen a lot of rv parks use unifi equipment. || you probably dont want to hear this but you should really just find a msp that specializes in this sort of setup if you want it to not be completely garbage. having random redditors design a business network for you is not going to end well. || cambium indooroutdoor wifi aps"
firewall logs monitoring,"hi everyone, were facing a frustrating authentication issue and hoping someone here might have some insights. background we recently had a vmware cluster incident that unfortunately corrupted the disk images for both our clearpass vms clearpass01 publisher, clearpass02 subscriber. we were unable to restore clearpass01, so we had to promote clearpass02 to become the publisher and then removed clearpass01 from the cluster configuration via clearpass02. environment clearpass policy manager version 6.12.4.305024 platform c2000v virtual appliance switches affected hpe procurve arubaosswitch example switch modelfirmware hp j9850a switch 5406rzl2, revision kb.16.11.0013 the problem since performing the promotion and removing the old node, clients connected to our hpe procurve switches like the 5406rzl2 mentioned above can no longer authenticate. authentication for devices on other switch types if any seems okay or is not the focus here, the issue is specific to the procurves. symptoms troubleshooting done 1. packet capture on clearpass clearpass02 we see incoming mac authentication accessrequests from the procurve switch ip. these get rejected 12 packets usually. immediately following the mac auth rejection, we see an 802.1x eap accessrequest come in from the switch. the username is typically hostcomputername.domain.local. clearpass processes this and sends an accesschallenge back to the switch likely requesting eap identity or starting the eap method. crucially clearpass receives no further response from the switch after sending the accesschallenge. 2. switch logs procurve the switch logs show numerous radius timeouts. we havent found any obvious errors like certificate validation failures, incorrect shared secrets though we plan to doublecheck, or radius server unreachable messages apart from the timeouts. 3. configuration checks weve confirmed clearpass02 is the active publisher. clearpass01 is removed from the cluster configuration on clearpass02. we know the procurve switches were configured with radius server entries for both clearpass01 the failed publisher and clearpass02 the nowpromoted publisher. we are reviewing the switch configurations to ensure clearpass01 is removed or correctly handled now. we have checked the firewall between the switches and clearpass02. traffic on udp1812 and udp1813 is logged as accepted and appears normal. our theory where were stuck it seems like the initial radius communication mac auth request, eap request from the switch to clearpass clearpass02 works. clearpass processes it and sends a response accesschallenge. however, the next step, where the switch should forward the clients eap response or its own part of the eap exchange back to clearpass, fails, resulting in a timeout on the switch side. since clearpass sends the challenge but gets no reply, it points towards either a the switch isnt receivingprocessing the accesschallenge correctly. b the switch receives the challenge, forwards it to the client, gets a response from the client, but then fails to send that response back to clearpass clearpass02. perhaps its trying to send the response via the now dead clearpass01 entry? c some subtle configuration mismatch postpromotion maybe related to nas entry for the switch, service rules, or certificate, despite logs looking clean?. the kb.16.11 firmware is fairly mature, so we dont immediately suspect a firmware bug, but arent ruling it out. weve checked the obvious logs and firewall but are running out of ideas on what could cause the communication to break down specifically after the accesschallenge is sent by clearpass. questions has anyone seen similar behavior after a clearpass publisher failurepromotion, especially with procurve switches on kb.16.x firmware connecting to cppm 6.12? any specific things to check on the procurve radius configuration kb.16.11 beyond the server ip, shared secret, and timeouts that might be relevant? radiusserver host ip key secret, aaa authentication portaccess ... crucially, how does the procurve handle multiple radius servers when one becomes unresponsive during an ongoing eap transaction? could there be a lingering configuration element related to the old clearpass01 on the switches causing this, even if clearpass02 is primary? e.g., stuck session state? any specific clearpass services, parameters, or logs beyond access tracker and packet captures we should scrutinize following the promotion on version 6.12.4? any help or pointers would be greatly appreciated! were kind of stuck. thanks! session logs of timed out request request log details for session sessionid time message 20250403 174526,362 info radiusserver.radius rlmservice starting service categorization ipaddressportmacaddress 20250403 174526,366 info radiusserver.radius service categorization time 4 ms 20250403 174526,366 info radiusserver.radius rlmservice the request has been categorized into service servicename 20250403 174526,366 info core.servicereqhandler service classification result servicename 20250403 174526,367 info radiusserver.radius rlmeaptls initiate 20250403 174526,367 info radiusserver.radius reqstupdatestate accesschallenge ipaddressportmacaddressstatevalue 20250403 174616,322 error radiusserver.radius reqstcleanlist deleting request sessid sessionid, state statevalue 20250403 174616,322 error radiusserver.radius reqstcleanlist packet ipaddressportportmacaddress recv timestamp resp timestamp 20250403 174616,322 info radiusserver.radius last eap packet processing time 4 ms 20250403 174616,322 info radiusserver.radius rlmpolicy starting policy evaluation. 20250403 174616,324 info common.endpointtable endpoint found in cache of size cachesize for mac macaddress 20250403 174616,324 info tat.alutagattrholderbuilder buildattrholder tags cannot be built for instanceid0 null authlocaluser 20250403 174616,324 info tat.gutagattrholderbuilder buildattrholder tags cannot be built for instanceid0 null guestuser 20250403 174616,325 info tat.onboardtagattrholderbuilder buildattrholder tags cannot be built for instanceid0 null onboard device user 20250403 174616,325 info core.petaskscheduler petaskscheduleradius started 20250403 174616,325 info core.petaskscheduler starting petaskauthsourcerestriction 20250403 174616,325 info core.petaskscheduler starting petaskrolemapping 20250403 174616,326 warn ldap.ldapquery failed to get value for attributesaccountstatus, memberof 20250403 174616,326 info core.petaskscheduler completed petaskauthsourcerestriction 20250403 174616,327 warn util.parameterizedstring getreplacedstrings failed to replace paramestring certificatesubjectcn, errorno values for paramcertificatesubjectcn 20250403 174616,327 error queryautzattributes failed to construct path from certificatesubjectcn 20250403 174616,327 error failed to get value for attributesattributeslist 20250403 174616,327 warn ldap.ldapquery failed to get value for attributesaccountstatus 20250403 174616,456 error http attribute query returned error404 20250403 174616,457 info core.petaskrolemapping roles rolename 20250403 174616,457 info core.petaskscheduler completed petaskrolemapping 20250403 174616,457 info core.petaskscheduler starting petaskpolicyresult 20250403 174616,457 info core.petaskscheduler completed petaskpolicyresult 20250403 174616,457 info core.petaskscheduler starting petaskenforcement 20250403 174616,458 info core.petaskenforcement enfprofiles enforcementprofilename 20250403 174616,458 info core.petaskscheduler completed petaskenforcement 20250403 174616,458 info core.petaskscheduler starting petaskradiusenfprofilebuilder 20250403 174616,458 info core.petaskscheduler starting petaskradiuscoaenfprofilebuilder 20250403 174616,458 info core.petaskscheduler starting petaskappenfprofilebuilder 20250403 174616,458 info core.petaskscheduler starting petaskagentenfprofilebuilder 20250403 174616,458 info core.petaskscheduler starting petaskpostauthenfprofilebuilder 20250403 174616,458 info core.petaskscheduler starting petaskgenericenfprofilebuilder 20250403 174616,458 info core.petaskgenericenfprofilebuilder getapplicableprofiles no app enforcement generic profiles applicable for this device 20250403 174616,459 info core.petaskradiusenfprofilebuilder enfprofileactionenforcementaction 20250403 174616,459 info core.petaskradiusenfprofilebuilder radius enfprofiles used enforcementprofilename 20250403 174616,459 info core.enfprofilecomputer getfinalsessiontimeout sessiontimeout sessiontimeout 20250403 174616,459 info core.petaskscheduler completed petaskgenericenfprofilebuilder 20250403 174616,459 info core.petaskscheduler completed petaskagentenfprofilebuilder 20250403 174616,459 info core.petaskscheduler completed petaskappenfprofilebuilder 20250403 174616,459 info core.petaskscheduler starting petaskclienforcement 20250403 174616,459 info core.petaskclienforcement starthandler request rejected. skip cli enforcement 20250403 174616,459 info core.petaskscheduler completed petaskradiusenfprofilebuilder 20250403 174616,459 warn core.petaskpostauthenfprofilebuilder handle fetching radius attributes from battery failed, errmsg 20250403 174616,459 info core.petaskpostauthenfprofilebuilder getapplicableprofiles no post auth enforcement profiles applicable for this device 20250403 174616,459 warn core.petaskradiuscoaenfprofilebuilder handle fetching radius attributes from battery failed, errmsg 20250403 174616,459 info core.petaskscheduler completed petaskclienforcement 20250403 174616,459 info core.petaskscheduler completed petaskpostauthenfprofilebuilder 20250403 174616,459 info core.petaskscheduler completed petaskradiuscoaenfprofilebuilder 20250403 174616,459 info core.petaskscheduler starting petaskauthstatusinfo 20250403 174616,459 info core.petaskscheduler starting petaskoutputpolicyres 20250403 174616,459 info core.petaskscheduler starting petasksessionlog 20250403 174616,472 info core.xpippolicyreshandler populateresponsetlv petaskpostureoutput does not exist. skip sending posture vafs 20250403 174616,472 info core.policyrescollector getsohr failed to generate sohr 20250403 174616,472 info core.policyrescollector getsohr failed to generate sohr 20250403 174616,472 info core.petaskscheduler completed petasksessionlog 20250403 174616,472 info core.petaskscheduler completed petaskoutputpolicyres 20250403 174616,472 info core.petaskscheduler completed petaskauthstatusinfo 20250403 174616,472 info core.petaskscheduler petaskscheduleradius completed 20250403 174616,473 info radiusserver.radius policy evaluation time 150 ms 20250403 174616,473 info radiusserver.radius rlmpolicy received drop enforcement profile 20250403 174616,473 info radiusserver.radius rlmpolicy policy server reply does not contain posturevalidationresponse || make sure you get an external backup asap, first task. check the access tracker for clues. check your auth source works when sourced from clearpass 2 for eap, if your doing authorisation. check the certificate on clearpass 2 radius eap looks good. also consider asking your question in the aruba sub. || crucially, how does the procurve handle multiple radius servers when one becomes unresponsive during an ongoing eap transaction? radius tracking is your best bet. i think by default the switch should mark unresponsive servers as dead. you can check that with show radius. perhaps its trying to send the response via the now dead clearpass01 entry? responses should always go to the node the response comes from. what happens if you simply remove clearpass01 from the switch? || does your clearpass02 server have a valid radius server certificate?"
firewall logs monitoring,"hey everyone, with two of my friends, we wanted to set up a shared subnet across our three homelabs, each in a different physical location. to do this, we used our existing infrastructure with proxmox and opnsense. i followed the vxlan bridge guide from the official opnsense documentation for the underlay, i decided to go with wireguard which ive been using for years and set up the vteps just like in the tutorial. at first, for a proof of concept, i just wanted to route the network between our three sites using vni 15. between two sites, everything worked perfectly. i set the mtu of my wireguard interfaces to 1600, as recommended in the opnsense forums, so that my bridges and vxlan interfaces could stay at 1500 mtu. that way, i didnt have to deal with custom mtus or tcp mss normalization issues. i also tested with dont fragment df flag across the internet, and mtu 1600 worked fine without fragmentation between the vtep interfaces of each site through the wireguard tunnel. but when i tried adding the third site, things got complicated. initially, i set up one wireguard interface per site with two peers one for each of the other two sites. then, on each firewall, i created two vxlan interfaces site 1 vxlan1 for vtepsite1 to vtepsite2 vxlan2 for vtepsite1 to vtepsite3 site 2 vxlan1 for vtepsite2 to vtepsite1 vxlan2 for vtepsite2 to vtepsite3 site 3 vxlan1 for vtepsite3 to vtepsite1 vxlan2 for vtepsite3 to vtepsite2 but then i hit a limitation in unicast mode as described in the opnsense guide, i cant use the same vni 15 on two vxlan interfaces. i get this error network identifier x already exists in this socket this caused some really weird behavior fw1 can communicate with fw2 and fw3 fw2 and fw3 cant communicate with each other over vxlan to fix this, i had to do something a bit weird with network bridges by assigning different vni ids per pair of sites fw1 to fw2 vni 15 fw1 to fw3 vni 16 fw2 to fw3 vni 17 i know this is not a standard vxlan setup at all, but its the only solution i found for now ive never done vxlan before . so, on each firewall, i now have a network bridge bridge0 that links the two vxlan interfaces and the physical nic fw1 bridge0 fw2 bridge0 fw3 bridge0 right now, this works, but im starting to realize its not maintainable at all. if i want to transport other networks like 10.8.16.024, 10.8.17.024, 10.8.18.024, id have to either create at least 3 new interfaces on each opnsense firewall 2 vxlan interfaces 1 nicvlan and another bridge. or create vlans on bridge0, but as far as i know, opnsense doesnt support vlans on a bridge interface. or use vxlans native vlan transport, but i dont really know how to do that on opnsense. i looked into multicast vxlan, which seems like the perfect solution for my use case, but wireguard doesnt support multicast, so thats not an option. id really like to avoid using ipsec if possible. so now im trying to figure out the best way to design this network so that its functional reliable fault tolerant and easy to monitor maintainable without adding too much complexity if i want to add a new subnet and ideally performant we have great fiber network it should be great to use it if anyone has experience with vxlan on opnsense or a similar setup, id love to hear your thoughts! im open to discussions about every part of my setup. thanks for your help! || functional reliable fault tolerant and easy to monitor maintainable without adding too much complexity if i want to add a new subnet and ideally performant we have great fiber network it should be great to use it honestly? abandon layer 2 and go for layer 3. then run bgp with your friends and you can exchange routes. everything is better at layer 3. if you are crazy enough to do layer 2, ideally your opnsense should not have any vxlan configuration on it. usually only the endpoints of a vxlan network here proxmox are aware of the layer 2 vxlan aspect, and all the nodes in the middle here opnsense and wireguard only see a plain layer 3 udp packet. || this boils down to how do you extend l2 between sites which is a question that engineers have been trying to answer for 20 years. the right answer is dont. the fun answer is vxlan like you want to do. the easy and expensive answer is metroe. the cluster fuck answer is routing individual hosts between sites and have a hub site. the hacky answer is mpls over gres. but seriously, if you arent familiar with vxlan, let alone a dynamic protocol for an underlay just avoid it and do layer 3. it saves a lot of heartache especially if you dont get any benefit from extending l2. || im a big vxlan guy. probably setup a dozen very large ip fabrics in my time. but it works best as a lan tool, low latency, with many paths supported by a layer 3 underlay. for your use case you are over complicating what you need. just go l3. vxlan isnt meant to bridge a broadcast domain over the wan."
