mot_cl√©,post_et_reponses
how to automate network monitoring,"hey all! network admin here, ive been asked by a local community college to tour around our large campus 20 or so networking students, show them the datacenter and a brief qa etc. ive never done something like this before and was wondering if you all have any advice or discussion you recommend? what advice would you have wanted to hear in your early years? so far i can come up with dont be afraid to make mistakes, but never hide them. you will get your hands dirty. learn how to use tools, dont be afraid of heights and crawl spaces. always carry a multitip screwdriver. learn something new every day. you will learn much faster trying something than reading about it. field work is king. automation is useful, but it isnt everything. know basic and intermediate commands and configs, or have offline access to them. make friends with the facilities team. be nice to everybody, but dont be afraid to say no to requests that go counter to securitypolicylogic and be able to explain why. youll need to know at least a little bit about many, many systems, and youll often need to prove that the network is not the root cause. anything im missing? thanks! || watch how others explain situations and learn how to translate bits, bytes, and packets into business impact. networking facilitates the business, so its very important to understand how it does. this will help prioritize issues both to you and others. || my network engineers dont touch equipment. the part about getting dirty and having to rackstack is more of a small shop thing. be clear about that. || use velcro, no zip ties!"
how to automate network monitoring,"i have a customer who we did a network design for just over a year ago. we talked them through all the pros and cons as part of the design process and they selected to terminate all the vlans onto their cisco switches and then just have a layer 3 transit up to the firewall. this firewall was easy to spec as it was essentially just a case of how big are your internet pipes, how much might they grow over the next 56 years. boom there is a firewall. we are now 12 months layer and they are saying we want to terminate all the vlans and they have a lot, and want more onto the firewall. i agree this is a superior and potentially more secure design but i suspect if we do this it will just overload the firewall as it just wasnt speced for that use case. the customer, and rightfully so, is saying give us some figures to backup that statement. that got me thinking.... what is the best way to do this? my initial thought process is put netflow in on the core switch and look at the traffic levels between the various vlans. we could also monitor the traffic levels on the svis its a cisco core switch and see what traffic levels they get. currently the customer is using prtg but is there some other tools that could give us better reporting? but what does reddit think? what have i missed? what else could i consider? ||  || you dont say anything about the fw capabilities. its very difficult to answer the question in the title if you dont specify the firewall itself. and i do agree with other comments it all depends what you want to do with the traffic when it hits the firewall. do you just want to do regular l4 filtering or are they going with something like l7 filtering appid with pa, ssl decryption? are you going to employ security profiles to filter ew traffic as well? is the firewall doing any ipsec tunneling or ravpn? basically, its not just the amount of traffic, its also what youre going to do with it. newer fortigates and pa series starting with 400 series are small beasts and can handle a lot of abuse of course, the more you need, the higher you go on the ladder when speccing the fw as well. as for routing, i disagree with some of the comments unless youre talking about very specific routing usually reserved for datacenters, firewalls are more than capable of doing it, at least major vendors in the field are. if youre talking about just intervlan routing, then double that. ive been in networking field for past 20 years, last 10 years mostly security engineering firewalls and unless im working with a very specific type of a company that absolutely needs to have line speed for intervlan traffic, all vlans are terminated on the firewall, no exception im done with the days of 2010 years ago when i was trying to figure out which acl on a switch is blocking something. || group networks inside a vrf and use the firewall as the gateway. this reduces the number of vlans on the firewall and allows east west between like networks with minimal security concern."
how to automate network monitoring,"hey all, i dont have a plethora of experience in specifics in networking. ive used and set up vlans, nats, and subnets multiple times. i work in the industrial automatic space for an oem that makes packaging equipment. our customers are often bigger companies that have their own specifications for networking. generally it makes sense and aligns with my understanding of networking hierarchy and security. but we have one customer who requires us to use managed switches, and will dictate to us which ip addresses we can use and often get down to the specifics of which deviceip is connected to which port on the switch. they require us to ship them the switch were using so they can provision and configure it, then they ship it back. all of that is fine, and makes sense. the confusing part for me is that in their specifications documentation, it specifies that a nat cannot be used anywhere in the system. what inevitably happens is the systems principal controller plc first port is on a specified subnet with the rest of the equipmentdevices. the controllers second port is configured to a different subnet, which then connects to the customers intranet through the managed switch to be monitored and maintained. i recently asked the person who essentially leads all automation equipment purchasing for that customer, and i asked if he knew why the company has a firm requirement of not using a nat. he just said, ohhh, no no no. nats are a big nono. since then, ive been reading and i, for the life of me, cannot understand why this could be. but i also admit i dont know enough to know where to look. in my mind, the way the second port is configured and then connected through the switch mimics the actions of a nat. can someone explain how im a silly goose thats overlooking something? thanks in advance! || ot equipment and their vendors are notoriously bad at anything security related. especially the vpn devices the vendors love to try to sneak on to the network to have remote access to their stuff. there is no need for nat if i give you the address space to use and a gateway to route traffic to. also, when i have to yank that vpn device out because the vendor has been hacked again i can easily replace it with my own. ifwhen we want to expand or connect or add additional automation or collect data i can do that with out having to rely on you to come back and readdress the equipment so that its routable on my network. ive seen ot equipment using insane subnets that are routable over the public internet. no your plc cannot have an address of 1.1.1.1 or 1.2.3.4 and no your hmi cannot be 8.8.8.8 or any other random address ive seen outside of rfc1918. long story short, its our network, if your equipment cant handle different ip addresses from whatever you think it should be, it is not welcome in our environment. that being said i bend over backwards to get ot vendors to see the light and do things the right way. || nat sometimes breaks applications. || for mei can see a couple reasons. one is to make sure devices stay physically isolated. no gateway to the outside world. only the plc and its endpoints. i also know plcs and vfds can be harsh on a network and having nat manage that net can cause issues with its broadcast multicast storms. and it may be a security red safety system policy that isolated networks are in place with no possible way to interfere with the safety control endpoints. the absence of nat also means no openvpn, openssl, wireguard, ipsec etc. can possibly gain access."
how to automate network monitoring,"hello fellow networking folks, im currently trying to build a small monitoring solution for multicasts. in our lab we have a nexus9000 c93108tcex running version 7.0. i want to start with this device and maybe later continue supporting others. the goal is to see for each interface which multicasts are entering and which are leaving. sflow seems to be a viable solution for this problem since it just samples a defined subset of all the packets passing through the monitored interfaces. for each sampled packets sflow provides some additional information. for me the source id index and the input interface value are most interesting. i am keeping to the field descriptions provided by wireshark since different sources call them differently. when a packets arrives from outside the switch on one monitored interface, everything works flawlessly. i can compare the two values to the values in the mibii interface description. both values match as they should. when a packets is leaving the switch the story goes differently. the input interface value is correct so i can still see, on which physical interface a packet entered the switch. source id index always displays hex 0x80000000. it should show the interface i am monitoring right now, the interface from wich the packet was sampled. if the situation stays like that i can only properly monitor incoming multicasts but i cannot monitor through which interfaces packets leave the switch. in my opinion the cisco documentation is not really clear if this behavior is expected or not. for nxos 10.5 i found sflow does not support egress sampling for multicast, broadcast, or unknown unicast packets. but the nxos 7 documentation states egress sflow of multicast traffic requires hardware multicast globaltxspan configuration. which i tried. the other sentence in there drove me totally nuts for an ingress sflow sample of multicast packets, the out port is reported as multiple ports with the exact number of egress ports. this is not supported on cisco nexus 9300ex and fxp platform switches. like, what does this even mean? i would interpret it as you can see how many interfaces an incoming packet will go to, but not on your device. but that should not affect what i can see on the sampled egress packet, right? i assume that either i am not smart enough to read the documentation correctly or the documentation is not coherent. so my question is is it possible to correctly sample the information for egress multicast traffic with my switch and if so, what needs to be done. if it is not possible i am interested how well other vendors support sflow monitoring of multicast packet especially arista. is it only cisco implementing it weirdly or is there a bigger reason for this. im also thinking about possible alternatives for my implementation and if you think they could be possible 1. combine the snooping and group report with the input data show ip igmp snooping groups. this would be possible but is no true monitoring. i wouldnt know when the switch does not pass a packet. 2. cycle the sflow monitoring port. if i monitor only one port at a time i always know where a one multicast enters and where it leaves 3. i look at some other interface data counters or something similar if there are any correlations i can use to match output multicasts to interfaces in some way. if you have any ideas id appreciate your help. || "
how to automate network monitoring,"hey everyone, with two of my friends, we wanted to set up a shared subnet across our three homelabs, each in a different physical location. to do this, we used our existing infrastructure with proxmox and opnsense. i followed the vxlan bridge guide from the official opnsense documentation for the underlay, i decided to go with wireguard which ive been using for years and set up the vteps just like in the tutorial. at first, for a proof of concept, i just wanted to route the network between our three sites using vni 15. between two sites, everything worked perfectly. i set the mtu of my wireguard interfaces to 1600, as recommended in the opnsense forums, so that my bridges and vxlan interfaces could stay at 1500 mtu. that way, i didnt have to deal with custom mtus or tcp mss normalization issues. i also tested with dont fragment df flag across the internet, and mtu 1600 worked fine without fragmentation between the vtep interfaces of each site through the wireguard tunnel. but when i tried adding the third site, things got complicated. initially, i set up one wireguard interface per site with two peers one for each of the other two sites. then, on each firewall, i created two vxlan interfaces site 1 vxlan1 for vtepsite1 to vtepsite2 vxlan2 for vtepsite1 to vtepsite3 site 2 vxlan1 for vtepsite2 to vtepsite1 vxlan2 for vtepsite2 to vtepsite3 site 3 vxlan1 for vtepsite3 to vtepsite1 vxlan2 for vtepsite3 to vtepsite2 but then i hit a limitation in unicast mode as described in the opnsense guide, i cant use the same vni 15 on two vxlan interfaces. i get this error network identifier x already exists in this socket this caused some really weird behavior fw1 can communicate with fw2 and fw3 fw2 and fw3 cant communicate with each other over vxlan to fix this, i had to do something a bit weird with network bridges by assigning different vni ids per pair of sites fw1 to fw2 vni 15 fw1 to fw3 vni 16 fw2 to fw3 vni 17 i know this is not a standard vxlan setup at all, but its the only solution i found for now ive never done vxlan before . so, on each firewall, i now have a network bridge bridge0 that links the two vxlan interfaces and the physical nic fw1 bridge0 fw2 bridge0 fw3 bridge0 right now, this works, but im starting to realize its not maintainable at all. if i want to transport other networks like 10.8.16.024, 10.8.17.024, 10.8.18.024, id have to either create at least 3 new interfaces on each opnsense firewall 2 vxlan interfaces 1 nicvlan and another bridge. or create vlans on bridge0, but as far as i know, opnsense doesnt support vlans on a bridge interface. or use vxlans native vlan transport, but i dont really know how to do that on opnsense. i looked into multicast vxlan, which seems like the perfect solution for my use case, but wireguard doesnt support multicast, so thats not an option. id really like to avoid using ipsec if possible. so now im trying to figure out the best way to design this network so that its functional reliable fault tolerant and easy to monitor maintainable without adding too much complexity if i want to add a new subnet and ideally performant we have great fiber network it should be great to use it if anyone has experience with vxlan on opnsense or a similar setup, id love to hear your thoughts! im open to discussions about every part of my setup. thanks for your help! || functional reliable fault tolerant and easy to monitor maintainable without adding too much complexity if i want to add a new subnet and ideally performant we have great fiber network it should be great to use it honestly? abandon layer 2 and go for layer 3. then run bgp with your friends and you can exchange routes. everything is better at layer 3. if you are crazy enough to do layer 2, ideally your opnsense should not have any vxlan configuration on it. usually only the endpoints of a vxlan network here proxmox are aware of the layer 2 vxlan aspect, and all the nodes in the middle here opnsense and wireguard only see a plain layer 3 udp packet. || this boils down to how do you extend l2 between sites which is a question that engineers have been trying to answer for 20 years. the right answer is dont. the fun answer is vxlan like you want to do. the easy and expensive answer is metroe. the cluster fuck answer is routing individual hosts between sites and have a hub site. the hacky answer is mpls over gres. but seriously, if you arent familiar with vxlan, let alone a dynamic protocol for an underlay just avoid it and do layer 3. it saves a lot of heartache especially if you dont get any benefit from extending l2. || im a big vxlan guy. probably setup a dozen very large ip fabrics in my time. but it works best as a lan tool, low latency, with many paths supported by a layer 3 underlay. for your use case you are over complicating what you need. just go l3. vxlan isnt meant to bridge a broadcast domain over the wan."
how to automate network monitoring,"goodmorning, i come with a question about network structure for a project. i would like to implement my own remote monitor and control web interface for my 3d printer farm. my current setup is the 3d printers are connected to raspberrypis with octoprint instances. some raspberrypis use octoprintdeploy this allows to run multiple octoprint instances on the same rp. with the 4 usb ports of a rp i have 4 3d printers connected. other rps run with a standard octoprint image connected to one printer. all the printers are in the same lan. i wrote a python flask api to communicate with the different octoprint instances thanks to their api keys. also a htmlcssjs frontend to be able to monitor and control the printers via web interface. everything works but only in the lan. now my question what is the best way to put the api and frontend in the cloud? how can i still have bidirectional communicate between my cloud flask api and my printers connected to my local wifi? do i need to add an extra lan api to make the bridge between cloud and private network? did somebody already work on a project similar? would love to hear your experiences || first i dont think this is quite the right sub for that. second read up on vpn and connect your cloud service with one to your local network || id recommend tailscale or cloudflare zero trust. you can connect raspberry to your own overlay vpn network and access it from any device within the same network. || i would advise against using flask in production environments as it is dev only framework. you can use fastapi instead, it is also faster, supports asynchronous calls and is more widely used, so you will find more exampleschatgpt will be more reliable. if you want cloud public frontend to connect to your internal endpoints, that will be very difficult if you dont already have any hybrid setup in place. in general, for the frontend you can try and experiment with vitereactjs. it is easy and straightforward to setup. for authentication, best practice is to use jwt."
how to automate network monitoring,"vlan 10 admin office includes staff wifi workstations, laptops, the printer, the time clock machine, and staff wifi for office staff. a policy will be implemented to ensure personal devices connect only to the guest wifi vlan 30 to maintain network security. vlan 20 pos payment systems amazon workspaces, pos system and credit card readers. vlan 30 guest wifi isolated from all internal systems, allowing only internet access. this includes three separate guest wifi networks covering the clubhouse, the course, and the driving range. vlan 40 iot media tvs, ensuring separation from businesscritical traffic. vlan 50 servers backups hosts the inhouse server and facilitates controlled access for vlan 10 and vlan 20. vlan 60 voip phone system dedicated vlan for the 14 voip phones to ensure call quality and reliability without interference from other network traffic. implementation strategy deploy a layer 3 switch to manage vlan routing while maintaining security. configure firewall rules to allow controlled communication between vlans where necessary. implement quality of service qos to prioritize critical pos, voip, and admin traffic. secure guest wifi by isolating it from internal vlans. futureproof the network for upcoming expansion and additional it infrastructure. implement ubiquiti networking equipment utilize ubiquiti access points, switches, and controllers for seamless wifi and network management. deploy atera it management software atera provides remote monitoring, network diagnostics, and automated maintenance, reducing downtime and increasing efficiency. || will likely get an a || personally, id be looking at terminating the l3 on the firewall not the l3 switch. also for fun, i prefer 666 for guest d || id keep switches at layer 2 and put layer 3 on the firewall. a little more centralized for all the rules."
how to automate network monitoring,"im a network engineer with 7 years of experience and know quite a bit of python network automation newbie where do i start? what tools, languages, and projects are best for beginners? im a network engineer with 7 years of experience working mostly with cli and manual configurations. i want to dive into automation but feel overwhelmed by the options ansible, netmiko, etc.. questions 1. what are the scopes in automation and how to even start from scratch? 2.which freeopensource tools are best for smallscale lab practice? 3. whats a good first project to automate e.g., config backups, vlan deployment? 4. any youtube courses, books, or labs youd recommend for handson learning? || the learning stuff for automation is kinda tough right now unless you commit to an environment. nokia and cisco both have course stuff but if youre not working with their gear it gets a little more precarious. your best bet is to get a lab going, find a use case and just get after it. the biggest hurdle for me has been interpreting yang docs, figuring out syntax without documentation, stuff like that. i have production automation i do in python and ansible, happy to answer questions if you want to message me. kirk byers has a popular course for netmiko which is probably a decent starting point. to answer some questions most of the tools are freeopensource. python and ansible both you can install on your personal machine and get started with immediately. project would depend on what test devices you have. you could set up eveng if you want to test something virtually but that setup alone is kind of a headache || check out this project if you can make a 16 gb vm with 8vcpus, this is a simple instruction guide to get yourself a box that has an ide, containerlab, ansible, python, and a leafspine topology two spines, four leafs, two hosts, and one router to experiement on. || if you can write code, you can automate stuff, its not rocket science. writing a loop that will log in to 100 devices and do show version, extract the model and code revision and shove it in csv file would take less time than doing this task manually thats a very simple, but useful example of automation. that said, one of the most important things i find with automation is config management. the goal is to be able to configure device without logging in to it. the bonus point which for me is imperative to see the config diff before you apply it. to achieve this with cisco nexus, one has to create a text config, then use tool like ansible to upload it, compare it and then execute the change if the diff looks good. to start with, one actually may still edit config by hand before uploading thats still in my mind miles better than typing in the cli. then you can start doing templates. then you can start integrating source of truth to grab variables for templates. it does get complicated, it is not easy to achieve. but it does feel great to run the network where people log in to devices only in case of emergency."
how to automate network monitoring,are pvst implementations different? even so how is a loop created without another connection on the 1300? network monitoring definitely shows large number of inbound broadcast packets on the port the c1300 is connectrd to... anyway my challenge for the day...start going through the config files with a fine tooth comb. || how is stp configured on this switch? how is stp configured on the switches that this switch connects to? how are the interfaces configured on each end? what were the log events recorded on both ends? || youre not giving us the whole picture. you must have two links between the devices. || sounds fishy.
how to automate network monitoring,"i have a small network of devices in a automation machine my company is building, it includes a couple plcs, a computer, an some linux based machine control devices all connected via a basic 8 port switch. the issue is that since there is no gateway or router involved i cannot set the resulting unidentified network on the computer to being a private network and thus it has to be treated as a public network, otherwise all unidentified networks would have to be treated as private. if i could get all connections to the specific nic to be identified as x and set to private then id have no issues. but i cannot get it to identify this network because theres no gateway or router involved. some reccomendations for how to handle this would be appreciated! i have so far tried just setting rules in the firewall so i can let the required traffic through regardless of whether the network is identified or not but i must not be setting up the right ones or doing it correctly because i cannot for the life of me get the communication i need to flow freely. i have also tried using the plc as the gateway but that still results in issues with connectivity. likely because the plc is kinda a dead end and isnt going to act like a router i think. || you can modify the windows registry to specify what zone specific network connections are in. i dont recall the exact path to the keys, but google should be able to tell you. not sure if you can do something similar with linux, but id be surprised if you couldnt."
