mot_cl√©,post_et_reponses
common network failures,"ive got a small enterprise network i am deploying.. a pair of c9336cfx2e running nxos 10.35 in vpc domain. since this is for the enterprise not an msp, i really see no advantage to running multiple vrfs, my preference is to keep things simple... although i have gone wthe best practice of keeping the vpc peerkeepalive on the management vrf by itself. what i really want to talk about is all of these mentions of having dedicated layer2 and dedicated layer3 links. i much prefer to have a nice fat 400gig vpc peer link on which i have the peergateway, layer3 peerrouter, fastconvergence, and autorecovery features enabled. the use case is for hpc and vdi all deployed into a single cabinet with a pure storage with file services... were looking at omnissa for vdi. but getting back to having dedicated layer3 which is often cited as a best practice the only advantages i see are to prevent routing issues during potential misconfigurations, and potentially faster recovery in certain failure scenarios.. ignoring misconfigurations lets assume they wont happen changes will be very minimal once this is up and running what am i missing, why is it a bp to add dedicated layer3 links? i am going to be running ospf in the network core on the same switches that host the vpc domain... why cant i just let that all run over the same vpc peerlink? please tell me what im missing here... not to mention if you look at the table on this link there are asterisks and other symbols next to l2 link and l3 link for different topological routing adjacencies ie. future support may be limited with dedicated l2l3 links if the environment expands || love this, youre clearly thinking this through. im a var and heres kinda what ive seen from customers and cisco ses in similar vpc builds dedicated layer 3 links give you fault isolation. if your vpc peerlink gets congested, flaps, or hits errors, you dont want routing protocols or northsouth traffic tied up in that. vpc peerlinks are really meant for eastwest l2 traffic and vpc control plane sync. when you push routing adjacencies and l3 over them, especially with ospf, recovery behavior can get messy under failure conditions. ciscos own best practice is to keep the vpc peerlink clean, and use a separate routed link often via the same pair of switches, sure for l3 adjacencies like ospf or bgp. helps avoid weird dependencies during convergence events. your setup with 400g and all the vpc enhancements sounds solid. if your use case is predictable and failure domains are small, it may still work fine. but if you anticipate growth or changes vdi scaleout, separation is worth it. dm me if you need more helpsupport! || we just use a virtual l3 link using svis 30. you want l3 connectivity between the n9ks right? || maybe it was before being able to use layer3 peerrouter? im on a big peerlink vpc like your config and its fine with vpc, ospf, bgp, multicast and without peerrouter it wouldnt be possible or half the traffic would just black hole."
common network failures,"the title states our issues unfortunately. our county has installed fiber and is due to be activated this upcoming week. we were told by the installers that our current infrastructure is not up to the task of delivering the higher speed to our patron computers. the current system was installed 14 years ago and consists of a cisco sg20050 fifty port gigabit smart switch. our existing cable is cat 5 not even 5e and is currently functional for 15 desktops. our security system is an old qsee standalone recorder and has its own poe for the cameras. all we do is access the footage through our network. so in my research i do not believe we need to rewire the cameras. during my research i am now fairly confident that if we buy cat 6 cable and attach male ends, that i can run the cable myself from the switch to the patrons and staff computers. however i do have some questions for the pros regarding a direction to go. 1. our existing cat 5 does have lines running around the library to four port junction boxes spread out for patron access. i believe we could eliminate those junction boxes in the library due to the fact wifi is more common now than 15ish years ago. honestly in the 4 years i have been here i have never seen anyone connect a cable to any provided ports. if eliminating the ports are a go ahead, then my guess is that we wont need a 50 port switch and we can get something smaller and cheaper. 2. the fiber internet we are due to get will start off as 1 gbps and eventually go up to 10 gbps. so the powers that be tell us is cat 6 adequate to handle the future speed or should i choose cat 6a or even cat 7, 8? 3. i doubt that the 15 year old switch is secure so i am asking of the experts here to please recommend a new switch that is both secure and is inexpensive that would work for us here? 4. i should mention that we have a tplink archer ax4400 to provide wireless access. would that be enough or should we get something better? thank you from myself and the library staff to anyone who can offer us advice. edit i just received word that after buying the cable and ends, we could swing 1000 to 1200 for a quality switch. || i think you could do the switch upgrade later or never. 1gbps for even 100 users is enough to support most typical usage like streaming, video calling, and web browsing. waiting another year or two would mean better availability for 2.55gbps switching solutions. i think thats what you want here, but its more feel good than practical impact on user experience. focus on reliable mbps of throughput not top speed as thats what your patrons really need. a solid 50mbps will enable 99 of what is possible on the internet. || for funding, are you aware of erate? it is a program where the feds cover 80 of cost for network equipment and infrastructure that provides internet access to the public this includes installing ethernet in the walls. it is primarily for schools but libraries can also take advantage of the funding. || so youve got a 50port gigabit switch. and 15 endpoints. and since you now just have got fiber, those 15 endpoints are not connected adequately anymore? do those 15 endpoints have a 1gbps link each? quick summary youre fine. cat 5 is fine. like, perfectly fine. may i ask, what actual problem are you trying to solve?"
common network failures,"hello everyone! ive recently been put in charge of a complete network replacement project at my company, taking over from a colleague whos no longer involved. while i have a technical background, this is my first time leading a project of this scale, and id really appreciate any advice from those of you whove been through something similar. the scope of the project includes designing a new network topology cleaning up existing racks and cable closets reorganizing patch panels, switches, and getting cable management under control replacing legacy switches with new ones and configuring them to support the updated network design right now, im trying to figure out what questions i should be asking, what to prioritize, and which common pitfalls to watch out for. heres what id love your input on what would your first steps be in a project like this? any templates, tools, or documentation methods you find invaluable? any common mistakes youve seen or made during network overhauls? thanks in advance any insight would be hugely appreciated! || ive wrapped up a network overhaul a month ago for one of our facilities and its my favorite project to do. i work in the manufacturing industry and oversee at least 6 facilities, and have led at least a dozen infrastructure overhauls. handling a project and seeing it through will require detailed planning and clear communication to stakeholders to help minimizeprevent unplanned issues. we still do things manuallyoldschool, nothing fancy. general overview 1. break down the project into small actionable tasks and identify who will be handling what. 2. document and review your network infrastructure logical and physical. identify and label critical portscables. i like to create a table where one column lists the connections from the patch panel to the current port interface, and a separate column lists where theyll be connecting to on the new network switch. i also like using visio to create visual diagram mapping 3. identify what services will be affected, so that these can be communicated to management. 4. review and verify current configs are backed up. then check the current configs will be able to apply on new switch or if you may need to write up a new template. 5. keep in mind the environment power, environment, humidity, etc. are you adding new idf? if also factor in accessibility to idf. 6. on the day of cutover or before cutover, do a final plan review with stakeholders to make sure any litle detaillast minutes changes went unnoticed and everything verbalizedcommunicated so that all individuals are on agreement. we had to involve devop team and our consultants to make sure their applications and services are safely shutdown, then resumed and verified. past mistakes that were madeissues experienced 1. incompatible hardware were orderedreceived. just doublecheck the specs sheets. 2. insufficient cables 3. the one time i forgo a final plan review previous network projects went without any hiccup, we ran into technicals that extended the outage by an hour past planned outage widnows. 4. unclear communication. be direct and concise in communication. vague and wordy communication will cause the team to fumble. feel free to message me for questions and support!"
common network failures,"hello everyone, i have a situation id like to discuss, and im curious if anyone has encountered something similar. the network topology involves ospf mpls mpbgp r1 rr cost 1 r3 r2 rr cost 20 r3 r1 rr cost 1 r2 rr there is an xconnect established between r3 and r1, as well as a backup pseudowire set up between r3 and r2. in the event of a link failure between r3 and r1, the primary pseudowire remains up because r3 can still reach r1 via r2. however, an issue arises in this setup. icmp works fine, but web traffic does not. the problem manifests as if its related to mtu, even though the mtu on the pseudowires is set to 9100, and a 1500byte ping with the df bit set passes through the pseudowire without any issues. am i missing something here? has anyone experienced a similar situation? thanks in advance for any insights! || have you done any captures yet? whats the mss of the tcp segments? 1460? how far do those packets make it? do you see any issues when using something like iperf to test? || double check all the interfaces in the path have an mtu at or above the pw mtu."
common network failures,"consulting network engineer with 16 years experience. recently became aware that bidi optics are relatively available to many manufacturers and definitely through third party optics mfgs.. im from wisconsin where we always seem to be behind the curve a few years.. but why has bidi not become the standard for fiber connections? i have so many customers who cant afford to just replace their om1 or om2 fiber, or dont have enough strands between locations but bidi basically solves most of my headaches is there a reason theyre not at least in my experience more common? are they prone to problems for some reason? || i use bidi optics everywhere. there is a slight difference in attenuation at different wavelengths but that hasnt been a problem for us. i have a handful of metro links where the upstream provider demanded we use duplex transceivers but i never really got a reason why. the only problem is matching a and b transceivers on a given link but honestly its a bit easier to explain to remote hands than trying to figure out which fiber is tx and rx and when they should roll the cable. || dont have enough strands between locations valid use case for bidi cant afford to just replace their om1 or om2 fiber bidi optics are designed for singlemode fiber, so you may or may not have much luck getting them to work with multimode e.g. it may link up at short distances while taking errors, or not link up at all at longer distance we use them a lot on dark fiber circuits between sites, around here a single strand of dark fiber is already very expensive so dualstrand is prohibitively expensive for most customers. within a building though, if you have singlemode its a good way to get more use out of it. not much for downsides, theres a slightly higher expense over a regular dualstrand optic cheaper than pulling more strands though and they need to be used in a matched pair, so youd need to make sure you have adequate spares around for both wavelengths. || but why has bidi not become the standard for fiber connections? because typically you are not short on fiber. when an isp pulls fiber into a building its typically a 96 core as an example, even for a single customer. it also requires matched optic pairs, and doesnt work well or at all with cwdmdwdm. basically unless you need it, it adds complexity, cost, and gotchyas down the road you wont have if you have the fiber available for regular duplex optics."
common network failures,"hi there, were trialing out sase products with the purpose of locking down saas apps to a centralized gateway, with the intention to split tunnel any other traffic directly not through the gateway. the problem is that, even with split tunnel policies in place to route all traffic normally outoftunnel, were still experiencing delays 30 60 seconds for any event that attempts to contact the domain controller logging in, uac prompts. we also cant join or unjoin from a domain while connected to these sase clientsgateways. note that local non domain joined accounts experience no delays. am i missing something here? why is it that if were setting the traffic to not go through the client, we experience delays? turning off the clientstopping the services fixes the issue. the vendor support hasnt been helpful so far, but youd think this would be a common issue if its affecting domain accounts. note weve tried different domains, networks onprem and offprem, locations, devices, and the problem is consistent || i feel like if you are doing a trial of something and you have to come here to ask that its probably not a vendor you should use. if turning off their client fixes the issue then thats the issue. they would need to explain why. || can you share which solution youre having an issue with? it might help with determining what the issue is, e.g. name resolution, access control, inspection, etc. || im guessing windows clients, do the packets actually get routed out of the device correctly? you could also check the traffic on the gateway, do traceroutes, packet captures with wireguard, check your clients dns settings, gpos or intune configs etc. just saying dns slow is kind of unhelpful, i hope you tried getting their support to gather more info instead of just saying fix pls."
common network failures,"our enterprise network has about 100 sites across the u.s. each site is its own private as. we have partial mesh of ipsec tunnels over various carriers resulting in a partial mesh of ebgp peerings. the issue is one sites topology gives it high rtt. during certain failures that high rtt site becomes transit for sites that are close together, even when lower rtt paths exist, due to equal aspath lengths. what is a good way to ensure the one high rtt site only becomes transit if it is the very last path? im thinking of prepending all advertisements from that one site but wonder what other ideas people have. || bgp has a pretty large list of metrics that can be tuned. prepending is the smart choice here for sure. if this is all over the internet, it would be simpler to just have more direct tunnels so that your sites can just skip the hub site that is causing you problems. hope that helps! || routemaps to prepend and modify localpref? maybe communities per site? enough options. || prepend my brother"
common network failures,"hi everyone, were facing a frustrating authentication issue and hoping someone here might have some insights. background we recently had a vmware cluster incident that unfortunately corrupted the disk images for both our clearpass vms clearpass01 publisher, clearpass02 subscriber. we were unable to restore clearpass01, so we had to promote clearpass02 to become the publisher and then removed clearpass01 from the cluster configuration via clearpass02. environment clearpass policy manager version 6.12.4.305024 platform c2000v virtual appliance switches affected hpe procurve arubaosswitch example switch modelfirmware hp j9850a switch 5406rzl2, revision kb.16.11.0013 the problem since performing the promotion and removing the old node, clients connected to our hpe procurve switches like the 5406rzl2 mentioned above can no longer authenticate. authentication for devices on other switch types if any seems okay or is not the focus here, the issue is specific to the procurves. symptoms troubleshooting done 1. packet capture on clearpass clearpass02 we see incoming mac authentication accessrequests from the procurve switch ip. these get rejected 12 packets usually. immediately following the mac auth rejection, we see an 802.1x eap accessrequest come in from the switch. the username is typically hostcomputername.domain.local. clearpass processes this and sends an accesschallenge back to the switch likely requesting eap identity or starting the eap method. crucially clearpass receives no further response from the switch after sending the accesschallenge. 2. switch logs procurve the switch logs show numerous radius timeouts. we havent found any obvious errors like certificate validation failures, incorrect shared secrets though we plan to doublecheck, or radius server unreachable messages apart from the timeouts. 3. configuration checks weve confirmed clearpass02 is the active publisher. clearpass01 is removed from the cluster configuration on clearpass02. we know the procurve switches were configured with radius server entries for both clearpass01 the failed publisher and clearpass02 the nowpromoted publisher. we are reviewing the switch configurations to ensure clearpass01 is removed or correctly handled now. we have checked the firewall between the switches and clearpass02. traffic on udp1812 and udp1813 is logged as accepted and appears normal. our theory where were stuck it seems like the initial radius communication mac auth request, eap request from the switch to clearpass clearpass02 works. clearpass processes it and sends a response accesschallenge. however, the next step, where the switch should forward the clients eap response or its own part of the eap exchange back to clearpass, fails, resulting in a timeout on the switch side. since clearpass sends the challenge but gets no reply, it points towards either a the switch isnt receivingprocessing the accesschallenge correctly. b the switch receives the challenge, forwards it to the client, gets a response from the client, but then fails to send that response back to clearpass clearpass02. perhaps its trying to send the response via the now dead clearpass01 entry? c some subtle configuration mismatch postpromotion maybe related to nas entry for the switch, service rules, or certificate, despite logs looking clean?. the kb.16.11 firmware is fairly mature, so we dont immediately suspect a firmware bug, but arent ruling it out. weve checked the obvious logs and firewall but are running out of ideas on what could cause the communication to break down specifically after the accesschallenge is sent by clearpass. questions has anyone seen similar behavior after a clearpass publisher failurepromotion, especially with procurve switches on kb.16.x firmware connecting to cppm 6.12? any specific things to check on the procurve radius configuration kb.16.11 beyond the server ip, shared secret, and timeouts that might be relevant? radiusserver host ip key secret, aaa authentication portaccess ... crucially, how does the procurve handle multiple radius servers when one becomes unresponsive during an ongoing eap transaction? could there be a lingering configuration element related to the old clearpass01 on the switches causing this, even if clearpass02 is primary? e.g., stuck session state? any specific clearpass services, parameters, or logs beyond access tracker and packet captures we should scrutinize following the promotion on version 6.12.4? any help or pointers would be greatly appreciated! were kind of stuck. thanks! session logs of timed out request request log details for session sessionid time message 20250403 174526,362 info radiusserver.radius rlmservice starting service categorization ipaddressportmacaddress 20250403 174526,366 info radiusserver.radius service categorization time 4 ms 20250403 174526,366 info radiusserver.radius rlmservice the request has been categorized into service servicename 20250403 174526,366 info core.servicereqhandler service classification result servicename 20250403 174526,367 info radiusserver.radius rlmeaptls initiate 20250403 174526,367 info radiusserver.radius reqstupdatestate accesschallenge ipaddressportmacaddressstatevalue 20250403 174616,322 error radiusserver.radius reqstcleanlist deleting request sessid sessionid, state statevalue 20250403 174616,322 error radiusserver.radius reqstcleanlist packet ipaddressportportmacaddress recv timestamp resp timestamp 20250403 174616,322 info radiusserver.radius last eap packet processing time 4 ms 20250403 174616,322 info radiusserver.radius rlmpolicy starting policy evaluation. 20250403 174616,324 info common.endpointtable endpoint found in cache of size cachesize for mac macaddress 20250403 174616,324 info tat.alutagattrholderbuilder buildattrholder tags cannot be built for instanceid0 null authlocaluser 20250403 174616,324 info tat.gutagattrholderbuilder buildattrholder tags cannot be built for instanceid0 null guestuser 20250403 174616,325 info tat.onboardtagattrholderbuilder buildattrholder tags cannot be built for instanceid0 null onboard device user 20250403 174616,325 info core.petaskscheduler petaskscheduleradius started 20250403 174616,325 info core.petaskscheduler starting petaskauthsourcerestriction 20250403 174616,325 info core.petaskscheduler starting petaskrolemapping 20250403 174616,326 warn ldap.ldapquery failed to get value for attributesaccountstatus, memberof 20250403 174616,326 info core.petaskscheduler completed petaskauthsourcerestriction 20250403 174616,327 warn util.parameterizedstring getreplacedstrings failed to replace paramestring certificatesubjectcn, errorno values for paramcertificatesubjectcn 20250403 174616,327 error queryautzattributes failed to construct path from certificatesubjectcn 20250403 174616,327 error failed to get value for attributesattributeslist 20250403 174616,327 warn ldap.ldapquery failed to get value for attributesaccountstatus 20250403 174616,456 error http attribute query returned error404 20250403 174616,457 info core.petaskrolemapping roles rolename 20250403 174616,457 info core.petaskscheduler completed petaskrolemapping 20250403 174616,457 info core.petaskscheduler starting petaskpolicyresult 20250403 174616,457 info core.petaskscheduler completed petaskpolicyresult 20250403 174616,457 info core.petaskscheduler starting petaskenforcement 20250403 174616,458 info core.petaskenforcement enfprofiles enforcementprofilename 20250403 174616,458 info core.petaskscheduler completed petaskenforcement 20250403 174616,458 info core.petaskscheduler starting petaskradiusenfprofilebuilder 20250403 174616,458 info core.petaskscheduler starting petaskradiuscoaenfprofilebuilder 20250403 174616,458 info core.petaskscheduler starting petaskappenfprofilebuilder 20250403 174616,458 info core.petaskscheduler starting petaskagentenfprofilebuilder 20250403 174616,458 info core.petaskscheduler starting petaskpostauthenfprofilebuilder 20250403 174616,458 info core.petaskscheduler starting petaskgenericenfprofilebuilder 20250403 174616,458 info core.petaskgenericenfprofilebuilder getapplicableprofiles no app enforcement generic profiles applicable for this device 20250403 174616,459 info core.petaskradiusenfprofilebuilder enfprofileactionenforcementaction 20250403 174616,459 info core.petaskradiusenfprofilebuilder radius enfprofiles used enforcementprofilename 20250403 174616,459 info core.enfprofilecomputer getfinalsessiontimeout sessiontimeout sessiontimeout 20250403 174616,459 info core.petaskscheduler completed petaskgenericenfprofilebuilder 20250403 174616,459 info core.petaskscheduler completed petaskagentenfprofilebuilder 20250403 174616,459 info core.petaskscheduler completed petaskappenfprofilebuilder 20250403 174616,459 info core.petaskscheduler starting petaskclienforcement 20250403 174616,459 info core.petaskclienforcement starthandler request rejected. skip cli enforcement 20250403 174616,459 info core.petaskscheduler completed petaskradiusenfprofilebuilder 20250403 174616,459 warn core.petaskpostauthenfprofilebuilder handle fetching radius attributes from battery failed, errmsg 20250403 174616,459 info core.petaskpostauthenfprofilebuilder getapplicableprofiles no post auth enforcement profiles applicable for this device 20250403 174616,459 warn core.petaskradiuscoaenfprofilebuilder handle fetching radius attributes from battery failed, errmsg 20250403 174616,459 info core.petaskscheduler completed petaskclienforcement 20250403 174616,459 info core.petaskscheduler completed petaskpostauthenfprofilebuilder 20250403 174616,459 info core.petaskscheduler completed petaskradiuscoaenfprofilebuilder 20250403 174616,459 info core.petaskscheduler starting petaskauthstatusinfo 20250403 174616,459 info core.petaskscheduler starting petaskoutputpolicyres 20250403 174616,459 info core.petaskscheduler starting petasksessionlog 20250403 174616,472 info core.xpippolicyreshandler populateresponsetlv petaskpostureoutput does not exist. skip sending posture vafs 20250403 174616,472 info core.policyrescollector getsohr failed to generate sohr 20250403 174616,472 info core.policyrescollector getsohr failed to generate sohr 20250403 174616,472 info core.petaskscheduler completed petasksessionlog 20250403 174616,472 info core.petaskscheduler completed petaskoutputpolicyres 20250403 174616,472 info core.petaskscheduler completed petaskauthstatusinfo 20250403 174616,472 info core.petaskscheduler petaskscheduleradius completed 20250403 174616,473 info radiusserver.radius policy evaluation time 150 ms 20250403 174616,473 info radiusserver.radius rlmpolicy received drop enforcement profile 20250403 174616,473 info radiusserver.radius rlmpolicy policy server reply does not contain posturevalidationresponse || make sure you get an external backup asap, first task. check the access tracker for clues. check your auth source works when sourced from clearpass 2 for eap, if your doing authorisation. check the certificate on clearpass 2 radius eap looks good. also consider asking your question in the aruba sub. || crucially, how does the procurve handle multiple radius servers when one becomes unresponsive during an ongoing eap transaction? radius tracking is your best bet. i think by default the switch should mark unresponsive servers as dead. you can check that with show radius. perhaps its trying to send the response via the now dead clearpass01 entry? responses should always go to the node the response comes from. what happens if you simply remove clearpass01 from the switch? || does your clearpass02 server have a valid radius server certificate?"
common network failures,"hello everyone, i have two aging hp 8212zl switches that are being replaced later in 2025. i recently discovered that poe redundancy is not configured on these switches. reviewing the poweroverethernet redundancy command, i just wanted to confirm if i am understanding this properly core show poweroverethernet status and counters system power status prestandard detect off system power status no redundancy poe power status no redundancy chassis poweroverethernet total available power 1200 w total failover power 900 w total redundancy power 0 w total used power 183 w 6w total remaining power 1017 w internal power 1 300wpoe connected. 2 300wpoe connected. 3 300wpoe connected. 4 300wpoe connected. external power eps1 not connected. eps2 not connected. with my core output showing above, if i enable n1, i could have 2 power supplies fail total? with the full command, my total available power is 1200w, so half of that would be reserved for redundancy 600w. as i am using only about 183w, this would leave me about 417w of remaining power. am i understanding this correctly? i have been crawling through our network and locating devices that have been misconfigured or without spare psu installed. we had a failure a few weeks ago in a zl chassis that only had 2 power supplies and it caused half of the switch to function. i am trying to prevent that with added psu and redundancy configuration. || "
common network failures,"when designing a network, how do you decide where to segment a network based on physical site characteristics? assuming everything is within derated link length limits, of course, at what point do you add an access switch to aggregate endpoint devices in a localised area? one per floor is the norm but would you really add a second switch to a warehouse with a secondfloor open air mezzanine and a grand total of 12 endpoints and no anticipation of expansion? in most cases, probably not. and if an addition is put on a building and the new area is going to double your number of links to 30, do you upgrade to a 48 port switch and run everything back to the central point, or do you add a remote 24 port uplinked back to the existing switch? depends on where that existong switch is located, where the end points are, and if theres anywhere suitable for a remote switch, right? so what about in new construction, or pre construction, when youre not forced to color within any preexisting lines? lacking any other motivation security, bandwidth demands, tradition what criteria do you use to rationalise the choice for or against adding an aggregation switch? how do you decide to break things up? do you actually crunch the numbers to compare the cost of additional hardware and terminations vs the decrease in amount of cable laid? how does the added granularity and introduction of a point of failure vunerability figure in to your decision? what about uncertainty regarding future expansion? the logistics of running another link at a later date? how does the layout of the building and distribution of endpoints impact your topology decisions? given two structures with the same sq footage and layout, one a multistory building the other a single story structure, how would the topology you designed for each differ? || "
