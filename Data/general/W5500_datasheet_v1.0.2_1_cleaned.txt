¬© Copyright 20 13 WIZnet Co., Ltd. All rights reserved. W5500 Datasheet Version 1.0.2 http://www.wiznet.co.kr 
 2 / 66 W5500 Datasheet Version1.0. 2 (November 2013) W5500 The W5500 chip is a Hardwired TCP/IP embedded Ethernet controller that provides easier Internet connection to embedded systems. W5500 enables users to have the Internet connectivity in their applications just by using the single chip in which TCP/ IP stack, 10/100 Ethernet MAC and PHY embedded. WIZnet ‚Äòs Hardwired TCP/IP is the market -proven technology that supports TCP, UDP, IPv4, ICMP, ARP, IGMP, and PPPoE protocols. W5500 embeds the 32Kbyte internal memory buffer for the Ethernet packet processing. If you use W5500, you can implement the Ethernet application just by adding the simple socket program. It‚Äôs faster and easier way rather than using any other Embedded Ethernet solution. Users can use 8 independent hardware sockets simultaneously. SPI (Se rial Peripheral Interface) is provided for easy integration with the external MCU. The W5500‚Äôs SPI supports 80 MHz speed and new efficient SPI protocol for the high speed network communication. In order to reduce power consumption of the system, W5500 prov ides WOL (Wake on LAN) and power down mode. Features - Support s Hardwired TCP/IP Protocols: TCP, UDP, ICMP, IPv4, ARP, IGMP, PPPoE - Support s 8 independent sockets simultaneously - Support s Power down mode - Support s Wake on LAN over UDP - Support s High Speed Serial Peripheral Interface(SPI MODE 0, 3) - Internal 32Kbytes Memory for TX/RX Buffers - 10BaseT/100BaseTX Ethernet PHY embedded - Support s Auto Negotiation (Full and half duplex, 10 and 100 -based ) - Not support s IP Fragmentation - 3.3V operation with 5V I/O signal tolerance - LED outputs (Full/Half duplex, Link, Speed, Active) - 48 Pin LQFP Lead -Free Package (7x7mm, 0.5mm pitch) 
 W5500 Datasheet Version1.0. 2 (November 2013) 3 / 66 Target Applications W5500 is suitable for the following embedded applications: - Home Network Devices: Set -Top Boxes, PVRs, Digital Media Adapters - Serial -to-Ethernet: Access Controls, LED displays, Wireless AP relays, etc. - Parallel -to-Ethernet: POS / Mini Printers, Copiers - USB-to-Ethernet: Storage Devices, Network Printers - GPIO-to-Ethernet: Home Network Sensors - Security Systems: DVRs, Network Cameras, Kiosks - Factory and Building Automations - Medical Monitoring Equipment - Embedded Servers 
 4 / 66 W5500 Datasheet Version1.0. 2 (November 2013) Block Diagram 
 W5500 Datasheet Version1.0. 2 (November 2013) 5 / 66 Table of Contents Pin Assignment ................................ ................................ .......................... 7 1 1.1 Pin Descriptions ................................ ................................ .............. 7 HOST Interface ................................ ................................ ......................... 12 2 2.1 SPI Operation Mode ................................ ................................ ........ 13 2.2 SPI Frame ................................ ................................ .................... 14 2.2.1 Address Phase ................................ ................................ ......... 14 2.2.2 Control Phase ................................ ................................ ......... 15 2.2.3 Data Phase ................................ ................................ ............ 17 2.3 Variable Length Data Mode (VDM) ................................ ....................... 17 2.3.1 Write Access in VDM ................................ ................................. 18 2.3.2 Read Access in VDM ................................ ................................ .. 21 2.4 Fixed Length Data Mode (FDM) ................................ .......................... 24 2.4.1 Write Access in FDM ................................ ................................. 25 2.4.2 Read Access in FDM ................................ ................................ .. 26 Register and Memory Organization ................................ ................................ 27 3 3.1 Common Register Block ................................ ................................ ... 29 3.2 Socket Register Block ................................ ................................ ...... 30 3.3 Memory ................................ ................................ ...................... 31 Register Descrip tions ................................ ................................ ................. 32 4 4.1 Common Registers ................................ ................................ ......... 32 4.2 Socket Registers ................................ ................................ ............ 44 Electrical Specifications ................................ ................................ ............. 59 5 5.1 Absolute Maximum Ratings ................................ ............................... 59 5.2 Absolute Maximum Ratings (Electrical Sensitivity) ................................ ... 59 5.3 DC Characteristics ................................ ................................ ......... 60 5.4 POWER DISSIPATION ................................ ................................ ........ 61 5.5 AC Characteristics ................................ ................................ ......... 61 5.5.1 Reset Timing ................................ ................................ .......... 61 5.5.2 Wake up Time ................................ ................................ ......... 61 5.5.3 Crystal Characteristics ................................ .............................. 61 5.5.4 SPI Timing ................................ ................................ ............. 62 5.5.5 Transformer Characteristics ................................ ........................ 63 5.5.6 MDIX ................................ ................................ .................... 63 Package Descriptions ................................ ................................ ................. 64 6 Document History Information ................................ ................................ ......... 65 
 6 / 66 W5500 Datasheet Version1.0. 2 (November 2013) Table of Figures Figure 1. W5500 Pin Layout ................................ ................................ ....... 7 Figure 2. External reference resistor ................................ ......................... 11 Figure 3. Crystal reference schematic ................................ ........................ 11 Figure 4. Variable Length Data Mode (SCSn controlled by the host) .................... 12 Figure 5. Fixed Length Data Mode (SCSn is always connected by Ground) ............. 12 Figure 6. SPI Mode 0 & 3 ................................ ................................ ........ 13 Figure 7. SPI Frame Format ................................ ................................ ..... 14 Figure 8. Write SPI Frame in VDM mode ................................ ...................... 18 Figure 9. SIMR Register Write in VDM Mode ................................ .................. 19 Figure 10. 5 Byte Data Write at 1th Socket‚Äôs TX Buffer Block 0x0040 in VDM mode .. 20 Figure 11. Read SPI Frame in VDM mode ................................ ..................... 21 Figure 12. S7_SR Read in VDM Mode ................................ ........................... 22 Figure 13. 5 Byte Data Read at Socket 3 RX Buffer Block 0x0100 in VDM mode ....... 23 Figure 14. 1 Byte Data Write SPI Frame in FDM mode ................................ ...... 25 Figure 15. 2 Bytes Data Write SPI Frame in FDM mode ................................ .... 25 Figure 16. 4 Bytes Data Write SPI Frame in FDM mode ................................ .... 25 Figure 17. 1 Byte Data Read SPI Frame in FDM mode ................................ ...... 26 Figure 18. 2 Bytes Data Read SPI Frame in FDM mode ................................ ..... 26 Figure 19. 4 Bytes Data Read SPI Frame in FDM mode ................................ ..... 26 Figure 20. Register & Memory Organization ................................ ................. 28 Figure 21. INTLEVEL Timing ................................ ................................ ..... 34 Figure 22. Reset Timing ................................ ................................ .......... 61 Figure 23. SPI Timing ................................ ................................ ............. 62 Figure 24. Transformer Type ................................ ................................ .... 63 Figure 25. Package Dimensions ................................ ................................. 64 
 W5500 Datasheet Version1.0. 2 (November 2013) 7 / 66 Pin Assignment 1 Figure 1. W5500 Pin Layout 1.1 Pin Descriptions Table 1. Pin Type Notation Type Description I Input O Output I/O Input / Output A Analog PWR 3.3V power GND Ground TXN TXP AGND AVDD RXN RXP DNC AVDD AGND EXRES1 AVDD NC1 2 3 4 5 6 7 8 9 10 11 1236 35 34 33 32 31 30 29 28 27 26 25W5500NC AGND AVDD AGND AVDD VBG AGND TOCAP AVDD 1V2O RSVD SPDLEDMOSI MISO SCLK SCSn XO XI/CLKIN GND VDD ACTLED DUPLED LINKLEDINTnAGND NC NC PMODE0 PMODE1 PMODE2 RSVD RSVD RSVD RSVD RSVD RSTn13 14 15 16 17 18 19 20 21 22 23 2448 47 46 45 44 43 42 41 40 39 38 37 48LQFP
 8 / 66 W5500 Datasheet Version1.0. 2 (November 2013) Table 2. W5500 Pin Description Pin N o Symbol Internal Bias1 Type Description 1 TXN - AO TXP/TX N Signal Pair The differential data is transmitted to the media on the TXP/TXN signal pair. 2 TXP - AO 3 AGND - GND Analog ground 4 AVDD - PWR Analog 3.3V power 5 RXN - AI RXP/RX N Signal Pair The differential data from the media is received on the RXP/RXN signal pair. 6 RXP - AI 7 DNC - AI/O Do Not Connect Pin 8 AVDD - PWR Analog 3.3V power 9 AGND - GND Analog ground 10 EXRES1 - AI/O External Reference Resistor It should be connected to an external resistor ( 12.4KŒ©, 1%) needed for biasing of internal analog circuits. Refer to the ‚ÄòExternal reference resistor ‚Äô (Figure.2) for details. 11 AVDD - PWR Analog 3.3V power 12 - - NC 13 - - NC 14 AGND - GND Analog ground 15 AVDD - PWR Analog 3.3V powe r 16 AGND - GND Analog ground 17 AVDD - PWR Analog 3.3V power 18 VBG - AO Band Gap Output Voltage This pin will be measured as 1.2V at 25‚ÑÉ. It must be left floating. 19 AGND - GND Analog ground 20 TOCAP - AO External Reference Capacitor This pin must be connected to a 4.7uF capacitor. The trace length to capacitor should be short to stabilize the internal signals. 21 AVDD - PWR Analog 3.3V power 22 1V2O - AO 1.2V Regulator output voltage 1 Internal Bias after hardware reset 
 W5500 Datasheet Version1.0. 2 (November 2013) 9 / 66 This pin must be connected to a 10nF capacitor. This is the output voltage of the internal regulator. 23 RSVD Pull-down I It must be tied to GND. 24 SPDLED - O Speed LED This shows the Speed status of the connected link. Low: 100Mbps High: 10Mbps 25 LINKLED - O Link LED This shows the Link status. Low: Link is established High: Link is not established 26 DUPLED - O Duplex LED This shows the Duplex status for the connected link. Low: Full -duplex mode High: Half -duplex mode 27 ACTLED - O Active LED This shows that there is Carrier sense (CRS) from the active Physical Medium Sub -layer (PMD) during TX or RX activity. Low: Carrier sense from the active PMD High: No carrier sense 28 VDD - PWR Digital 3.3V Power 29 GND - GND Digital Ground 30 XI/CLKIN - AI Crystal input / External Clock input External 25MHz Crystal Input. This pin can also be connected to single -ended TTL oscillator (CLKIN). 3.3V clock should be applied for the External Clock input. If this method is implemented, XO should be left unconnected. Refer to the ‚ÄòCrystal reference schematic ‚Äô (Figure.3) for details. 31 XO - AO Crystal output External 25MHz Crystal Output Note: Float this pin if using an external clock being driven through XI/CLKIN 32 SCSn Pull-up I Chip Select for SPI bus This pin can be asserted low to select W5500 in SPI interface. Low: selected 
 10 / 66 W5500 Datasheet Version1.0. 2 (November 2013) High: deselected 33 SCLK - I SPI clock input This pin is used to receive SPI Clock from SPI master. 34 MISO - O SPI master input slave(W5500) output 35 MOSI - I SPI master output slave(W5500) input 36 INTn - O Interrupt output (Active low) Low: Interrupt asserted from W5500 High: No interrupt 37 RSTn Pull-up I Reset (Active low) RESET should be held low at least 500 us for W5500 reset. 38 RSVD Pull-down I NC 39 RSVD Pull-down I NC 40 RSVD Pull-down I NC 41 RSVD Pull-down I NC 42 RSVD Pull-down I NC 43 PMODE2 Pull-up I PHY Operation mode select pins These pins determine the network mode. Refer to the below table for details. PMODE [2:0] Description 2 1 0 0 0 0 10BT Half -duplex, Auto -negotiation disabled 0 0 1 10BT Full -duplex, Auto -negotiation disabled 0 1 0 100BT Half -duplex, Auto -negotiation disabled 0 1 1 100BT Full -duplex, Auto -negotiation disabled 1 0 0 100BT Half -duplex, Auto -negotiation enabled 1 0 1 Not used 1 1 0 Not used 1 1 1 All capable, Auto -negotiation enabled. 44 PMODE1 Pull-up I 45 PMODE0 Pull-up I 46 - - - NC 47 - - - NC 48 AGND - GND Analog ground 
 W5500 Datasheet Version1.0. 2 (November 2013) 11 / 66 The 12.4K‚Ñ¶(1%) Resistor should be connected between EXRES1 pin and analog ground (AGND) as below. Figure 2. External reference resistor The crystal reference schematic is shown as below. Figure 3. Crystal reference schematic 
 12 / 66 W5500 Datasheet Version1.0. 2 (November 2013) HOST Interface 2 W5500 provides SPI (Serial Peripheral Interface) Bus Interface with 4 signals (SCSn, SCLK, MOSI, MISO) for external HOST interface, and operate s as a SPI Slave. The W5500 SPI can be connected to MCU as shown in Figure 4 and Figure 5 according to its operation mode (Variable Length Data / Fixed Length Data Mode) which will be explained in .3 and .4. In Figure 4, SPI Bus can be shared with other SPI Devices. Since the SPI Bus is dedicated to W5500, SPI Bus cannot be shared with other SPI Devices. It is shown in Figure 5. At the Variable Length Data mode (as shown in Figure 4), it is possible to share the SPI Bus with other SPI devices. However, at the Fixed Length Data mode (as shown in Figure 5), the SPI Bus is dedicated to W5500 and can ‚Äôt be shared with other devices. Figure 4. Variable Length Data Mode (SCSn controlled by the host) Figure 5. Fixed Length Data Mode (SCSn is always connected by Ground) The SPI protocol defines four modes for its operation (Mode 0, 1, 2, 3).Each mode differs according to the SCLK polarit y and phase. The only difference between SPI Mode 0 and SPI Mode 3 is the polarity of the SCLK signal at the inactive state. With SPI Mode 0 and 3, data is always latched in on the rising edge of SCLK and always output on the falling edge of SCLK. SPI MASTER MCU (External Host)SPI SLAVE W5500 SCSn SCLK MOSI MISOSCSn SCLK MOSI MISO SPI MASTER MCU (External Host)SPI SLAVE W5500 SCSn SCLK MOSI MISOSCSn SCLK MOSI MISO
 W5500 Datasheet Version1.0. 2 (November 2013) 13 / 66 The W5 500 supports SPI Mode 0 and Mode 3. Both MOSI and MISO signals use transfer sequence from Most Significant Bit (MSB) to Least Significant Bit (LSB) when MOSI signal transmits and MISO signal receives. MOSI & MISO signals always transmit or receive in sequen ce from the Most Significant Bit (MSB) to Least Significant Bit (LSB). Figure 6. SPI Mode 0 & 3 2.1 SPI Operation Mode W5500 is controlled by SPI Frame (Refer to the .2 SPI Frame) which communicates with the External Host. W5500 SPI Frame consists 3 phases, Address Phase, Control Phase and Data Phase. Address Phase specifies 16 bits Offset Address for W5500 Register or TX/RX Memory. Control Phase specifies the block to which Offset (set by Address Phase) belongs, and specifies Read/Write Access Mode and SPI Operation Mode (Variable Length Data / Fixed Length Data Mode). And Data Phase specifies random length (N -bytes, 1 ‚â§ N) Data or 1 byte, 2 bytes and 4 bytes Data. If SPI Operation Mode is set as Variable Length Data Mode (VDM), SPI Bus Signal SCSn must be controlled by the External Host with SPI Frame step. At the Variable Len gth Data Mode, SCSn Control Start (Assert (High -to-Low)) informs W5500 of SPI Frame Start (Addres s Phase), and SCSn Control End (De -assert (Low -toHigh) informs W5500 of SPI Frame End (Data Phase End of random N byte). SCLK MISO/MOSISampling Toggling Mode 3: SCLK idle level highSCLK MISO/MOSISampling Toggling Mode 0: SCLK idle level low
 14 / 66 W5500 Datasheet Version1.0. 2 (November 2013) 2.2 SPI Frame W5500 SPI Frame consists of 16bits Offset Address in Address Phase, 8bits Control Phase and N bytes Data Phase as shown in Figure 7. The 8bits Control Phase is reconfigured with Block Select bits (BSB[4:0]), Read/Write Access Mode bit (RWB) and SPI Operation Mode (OM[1:0]). Block Select bits select the block to which the Offset Address belongs. Figure 7. SPI Frame Format W5500 supports Sequential Data Read/Write. It processes the data from the base (the Offset Address which is set for 2/4/N byte Sequential data processing) and the next data by increasing the Offset Address (auto increment addressing) by 1. 2.2.1 Address Phase This A ddress Phase specifies the 16 bits Offset Address for the W5500 Registers and TX/RX Buffer Blocks. The 16-bit Offset Address value is transferred from MSB to LSB sequentially. The SPI frame with 2/4/N byte data phase supports the Sequential Data Read/Write in which Offset address automatically increases by 1 every 1 byte data. 16btis Offset Address0 1 2 3 Data 1Bit15 765432107654321076543210 Control ByteN+2 Data N76543210. . .Address Phase Control PhaseData Phase N >= 1 MSB first MSB first 141312111098 Block Select BitsOP ModeR W
 W5500 Datasheet Version1.0. 2 (November 2013) 15 / 66 2.2.2 Control Phase The Control Phase specifies the Block to which the Offset Address (set by Address Phase ) belongs, the Read/Write Access Mode and the SPI Operation Mode. 7 6 5 4 3 2 1 0 BSB4 BSB3 BSB2 BSB1 BSB0 RWB OM1 OM0 Bit Symbol Description 7~3 BSB [4:0] Block Select Bits W5500 has Common Register, 8 Socket Register, TX/RX Buffer Block for each Socket. The next table shows the Block selected by BSB[4:0]. BSB [4:0] Meaning 00000 Selects Common Register. 00001 Selects Socket 0 Register 00010 Selects Socket 0 TX Buffer 00011 Selects Socket 0 RX Buffer 00100 Reserved 00101 Selects Socket 1 Register 00110 Selects Socket 1 TX Buffer 00111 Selects Socket 1 RX Buffer 01000 Reserved 01001 Selects Socket 2 Register 01010 Selects Socket 2 TX Buffer 01011 Selects Socket 2 RX Buffer 01100 Reserved 01101 Selects Socket 3 Register 01110 Selects Socket 3 TX Buffer 01111 Selects Socket 3 RX Buffer 10000 Reserved 10001 Selects Socket 4 Register 10010 Selects Socket 4 TX Buffer 10011 Selects Socket 4 RX Buffer 10100 Reserved 10101 Selects Socket 5 Register 
 16 / 66 W5500 Datasheet Version1.0. 2 (November 2013) 10110 Selects Socket 5 TX Buffer 10111 Selects Socket 5 RX Buffer 11000 Reserved 11001 Selects Socket 6 Register 11010 Selects Socket 6 TX Buffer 11011 Selects Socket 6 RX Buffer 11100 Reserved 11101 Selects Socket 7 Register 11110 Selects Socket 7 TX Buffer 11111 Selects Socket 7 RX Buffer If the Reserved Bits are selected, it can cause the mal -function of the W5500. 2 RWB Read/Write Access Mode Bit This sets Read/Write Access Mode. ‚Äò0‚Äô: Read ‚Äò1‚Äô: Write 1~0 OM [1:0] SPI Operation Mode Bits This sets the SPI Operation Mode. SPI Operation Mode supports two modes, the Variable Length Data Mode and the Fixed Length Data Mode. - Variable Length Data Mode (VDM): Data Length is controlled by SCSn. External Host makes SCSn Signal Assert (High -to-Low) and informs the start of the SPI Frame Address Phase to W5500. Then the external host transfers the Control Phase with OM[1:0]=‚Äô00‚Äô. After N -Bytes Data Phase transfers, SCSn Signal is De -asserted (Low-to-High) and informs the end of the SPI Frame Data Phase to W5500. In VDM Mode, the SCSn must be controlled with SPI Frame unit by the External Host. (Refer to the Figure 4) 
 W5500 Datasheet Version1.0. 2 (November 2013) 17 / 66 - Fixed Length Data Mode ( FDM): In FDM, the Data Length is set by OM[1:0], these are not ‚Äò00‚Äô value. So, the SCSn signal should be Low state, and has one Length type (among 1 Bytes, 2 Bytes, 4 Bytes) according to the OM[1:0] value. (Refer to the Figure 5.) The next table shows the SPI Operation Mode according to the OM[1:0]. OM[1:0] Meaning 00 Variable Data Length Mode, N -Bytes Data Phase (1 ‚â§ N) 01 Fixed Data Length Mode, 1 Byte Data Length (N = 1) 10 Fixed Data Length Mode, 2 Byte Data Length (N = 2) 11 Fixed Data Length Mode, 4 Byte Data Length (N = 4) 2.2.3 Data Phase With the Control Phase set by the SPI Operation Mode Bits OM[1:0], the Data Phase is set by two types of length, one type is the N -Bytes length (VDM mode) and the other type is 1/2/4 Bytes (FDM mode). At this time, 1 byte data is transferred through MOSI or MISO signal from MSB to LSB sequentially. 2.3 Variable Length Data Mode (VDM) In VDM mode, the SPI Frame Data Phase Length is determined by SCSn Control of the External Host. That means that the Data Phase Length can have random value (Any length from 1 Byte to N Bytes) according to the SCSn Control. The OM[1:0] of the Control Phase should be ‚Äò00‚Äô value in VDM mode. 
 18 / 66 W5500 Datasheet Version1.0. 2 (November 2013) 2.3.1 Write Access in VDM Figure 8. Write SPI Frame in VDM mode Figure 8 shows the SPI Frame when the external host accesses W5500 for writing. In VDM mode, the RWB signal is ‚Äò1‚Äô (Write), OM[1:0] is ‚Äò00‚Äô in SPI Frame Control Phase. At this time the External Host assert (High -to-Low) SCSn signal before transmitting SPI Frame. Then the Host transmits SPI Frame ‚Äôs all bits to W5500 through MOSI signal. All bits are synchronized with the falling edge of the SCLK. After finishing the SPI Frame transmit, the Host deasserts SCSn signal (Low -toHigh). When SCSn is Low and the Data Phase continues, the Sequential Data Write can be supported. RWBSCSn MOSI 7 6 5 4 3 2 1 0 4 3 2 0 1514 3 2 1 0 1312 0 SCLK12131415 16 bits Offset Address BSB[4:0]1718 16 20212223 2526 24 2728293031 8-bit Data 1MODE0MODE3 19 1 MOSI 7 6 5 4 3 2 1 0 7 6 5 4 3 2 1 07 6 5 4 3 2 1 0 MISOSCSn SCLK3334 32 3536373739 8N + 16 8N + 24 8-bit Data 2 ... 8-bit Data N...OM[1:0] MISOW00SCSn shoud be remained low until SPI Frame Transmit done. SCSn Should be remained low until SPI Frame Transmit done.SPI Frame Start SPI Frame End
 W5500 Datasheet Version1.0. 2 (November 2013) 19 / 66 1 Byte WRITE Access Example When the Host writes Data 0xAA to ‚ÄòSocket Interrupt Mask Register ( SIMR) of Common Register Block by using VDM mode, the data is written with the SPI Frame below. Offset Address = 0x0018 BSB[4:0] = ‚Äò00000‚Äô RWB = ‚Äò1‚Äô OM[1:0] = ‚Äò00‚Äô 1st Data = 0xAA The External Host asserts (High -to-Low) SCSn before transmitting SPI Frame, then the Host transmits 1 bit with synchronizing the Toggle SCLK. The External Host de - asserts (Low -to-High) the SCSn at the end of SPI Frame transmit. (Refer to the Figure 9) Figure 9. SIMR Register Write in VDM Mode SCSn 
 20 / 66 W5500 Datasheet Version1.0. 2 (November 2013) N-Bytes WRITE Access Example When the Host writes 5 Bytes Data (0x11, 0x22, 0x33, 0x44, 0x55) to Socket 1 ‚Äôs TX Buffer Block 0x0040 Address by using VDM mode, 5 bytes data are written with the SPI Frame below. Offset Address = 0x0040 BSB[4:0] = ‚Äò00110‚Äô RWB = ‚Äò1‚Äô OM[1:0] = ‚Äò00‚Äô 1st Data = 0x11 2nd Data = 0x22 3rd Data = 0x33 4th Data = 0x44 5th Data = 0x55 The N -Bytes Write Access is shown in Figure 10. The 5 bytes of Data (0x11, 0x22, 0x33, 0x44, 0x55) are written sequentially to Socket 1 ‚Äôs Tx Buffer Block Address 0x0040 ~ 0x0044. The External Host asserts (High -to-Low) SCSn before transmitting SPI Frame. The External Host de -asserts (Low -to-High) the SCSn at the end of SPI Frame transmit. Figure 10. 5 Byte Data Write at 1th Socket ‚Äôs TX Buffer Block 0x0040 in VDM mode SCSn SCSn 
 W5500 Datasheet Version1.0. 2 (November 2013) 21 / 66 2.3.2 Read Access in VDM Figure 11. Read SPI Frame in VDM mode Figure 11 shows the SPI Frame when external host accesses W5500 for reading In VDM mode, the RWB signal is ‚Äò 0‚Äô (Write), OM[1:0] is ‚Äò00‚Äô in SPI Frame Control Phase. At this time the External Host assert (High -to-Low) SCSn signal before transmitting SPI Frame. Then the Host transmits Address and Control Phase all bits to W5500 through MOSI signal. All bits are synchronized with the falling edge of the SCLK. Then the Host receives all bits of Data Phase with synchronizing the rising edge of Sampling SCLK through MISO signal. After finishing the Data Phase receive, the Host deasserts SCSn signal (Low -toHigh). When SCSn is Low and the Data Phase continues to receiv e, the Sequential Data Read can be supported. MOSI MISOSCSn SCLK3334 32 3536373839...8N + 16 8N + 24 7 6 5 4 3 2 1 0 7 6 5 4 3 2 1 07 6 5 4 3 2 1 08-bit Data 2 ... 8-bit Data NSCSn Should be remained low until SPI Frame Transmit & Receive done.SPI Frame EndSCSn MOSI 4 3 2 0 1514 3 2 1 0 13 MISO12 0 SCLK12131415 16bits Offset Address1718 16 20212223 2526 24 2728293031 8-bit Data 1MODE0MODE3 19 1 7 6 5 4 3 2 1 0BSB[4:0] RWBOM[1:0] R00SCSn shoud be remained low until SPI Frame Transmit & Receive done.SPI Frame Start
 22 / 66 W5500 Datasheet Version1.0. 2 (November 2013) 1 Byte READ Access Example When the Host reads the ‚ÄòSocket Status Register(S7_SR) of the Socket 7 ‚Äôs Register Block by using VDM mode, the data is read with the SPI Frame below. Let ‚Äôs S7_SR to ‚ÄòSOCK_ESTABLISH ED (0x17) ‚Äô. Offset Address = 0x0003 BSB[4:0] = ‚Äò11101‚Äô RWB = ‚Äò0‚Äô OM[1:0] = ‚Äò00‚Äô 1st Data = 0x17 The External Host asserts (High -to-Low) SCSn signal before transmitting SPI Frame, then the Host transmits Address and Control Phase to W5500 through the MOSI signal. Then the Host receives Data Phase from the MISO signal. After finishing the Data Phase receives, the Host deasserts SCSn signal (Low -toHigh). (Refer to the Figure 12.) Figure 12. S7_SR Read in VDM Mode SCSn 
 W5500 Datasheet Version1.0. 2 (November 2013) 23 / 66 N-Bytes Read Access Example When the Host reads 5 Bytes Data (0xAA, 0xBB, 0xCC, 0xDD, 0xEE) from the Socket 3‚Äôs RX Buffer Block 0x0100 Address by using VDM mode, 5 bytes data are read with the SPI Frame as below. Offset Address = 0x0100 BSB[4:0] = ‚Äò01111‚Äô RWB = ‚Äò0‚Äô OM[1:0] = ‚Äò00‚Äô 1st Data = 0xAA 2nd Data = 0xBB 3rd Data = 0xCC 4th Data = 0xDD 5th Data = 0xEE The N -Bytes Read Access is shown in Figure 13. The 5 bytes of Data (0xAA, 0xBB, 0xCC, 0xDD, 0xEE) are read sequentially from the Socket 3 ‚Äôs Rx Buffer Block Address 0x0100 ~ 0x0104. The External Host asserts (High -to-Low) SCSn before transmitting SPI Frame. The External Host de -asserts (Low -to-High) the SCSn at the end of the SPI Frame Data Phase. Figure 13. 5 Byte Data Read at Socket 3 RX Buffer Block 0x0100 in VDM mode SCSn SCSn 
 24 / 66 W5500 Datasheet Version1.0. 2 (November 2013) 2.4 Fixed Length Data Mode (FDM) The FDM mode can be used when the External Host cannot control SCSn signal. The SCSn signal should be tied to Low (Always connected to GND) and it is not possible to share the SPI Bus with other SPI Devices. (Refer to the Figure 5.) In VDM mode, Data Phase length is controlled by SCSn control. But in FDM mode, Data Phase length i s controlled by OM[1:0] value ( ‚Äò01‚Äô / ‚Äò10‚Äô / ‚Äò11‚Äô) which is the SPI Operation Mode Bits of the Control Phase. As the SPI Frame of FDM mode is the same as SPI Frame of VDM mode (1Byte, 2 Bytes, 4 Bytes SPI Frame) except for the SCSn signal control and OM[1:0] setting, the detail about FDM mode is not described in this section. It is not recommended to use the FDM mode unless you are in inevitable status. In addition, we use only 1/2/4 Bytes SPI Frame, as described in ‚Äò.4.1 ‚Äô & ‚Äò.4.2 ‚Äô. Using SPI Frame with other length of Data will cause malfunction of W5500. 
 W5500 Datasheet Version1.0. 2 (November 2013) 25 / 66 2.4.1 Write Access in FDM 1 Bytes WRITE Access Figure 14. 1 Byte Data Write SPI Frame in FDM mode 2 Bytes WRITE Access Figure 15. 2 Bytes Data Write SPI Frame in FDM mode 4 Bytes WRITE Access Figure 16. 4 Bytes Data Write SPI Frame in FDM mode 
 26 / 66 W5500 Datasheet Version1.0. 2 (November 2013) 2.4.2 Read Access in FDM 1 Byte READ Access Figure 17. 1 Byte Data Read SPI Frame in FD M mode 2 Bytes READ Access Figure 18. 2 Bytes Data Read SPI Frame in FDM mode 4 Bytes READ Access Figure 19. 4 Bytes Data Read SPI Frame in FDM mode 
 W5500 Datasheet Version1.0. 2 (November 2013) 27 / 66 Register and Memory Organization 3 W5500 has one Common Register Block, eight Socket Register Blocks, and TX/RX Buffer Blocks allocated to each Socket. Each block is selected by the BSB[4:0](Block Select Bit) of SPI Frame. Figure 20 shows the selected block by the BSB[4:0] and the available offset addre ss range of Socket TX/RX Buffer Blocks. Each Socket ‚Äôs TX Buffer Block exists in one 16KB TX memory physically and is initially allocated with 2KB. Also, Each Socket ‚Äôs RX Buffer Block exists in one 16KB RX Memory physically and is initially allocated with 2KB. Regardless of the allocated size of each Socket TX/RX Buffer, it can be accessible within the 16 bits offset address range (From 0x0000 to 0xFFFF). Refer to ‚Äò.3‚Äô for more information about 16KB TX/RX Memory organization and access method. 
 28 / 66 W5500 Datasheet Version1.0. 2 (November 2013) Figure 20. Register & Memory Organization Block Select BitsBlocksPhysical 16KB RX Memory16bit Offset Address Valid Range ...11111 (0x1F) 11110 (0x1E) 11101 (0x1E) 11100 (0x1C) 11011 (0x1B) 11010 (0x1A) 11001 (0x19) 11000 (0x18) 10111 (0x17) 10110 (0x16) 10101 (0x15) 10011 (0x13) 10010 (0x12) 10001 (0x11) 01000 (0x10) 01111 (0x0F) 01110 (0x0E) 01101 (0x0D) 01100 (0x0C) 01011 (0x0B) 01010 (0x0A) 01001 (0x09) 01000 (0x08) 00111 (0x07) 00110 (0x06) 00101 (0x05) 00011 (0x03) 00010 (0x02) 00001 (0x01) 00000 (0x00)00100 (0x04)10100 (0x14)Socket 7 RX Buffer Socket 7 TX Buffer Socket 7 Register Reserved Socket 6 RX Buffer Socket 6 TX Buffer Socket 6 Register Reserved Socket 5 RX Buffer Socket 5 TX Buffer Socket 5 Register Socket 4 RX Buffer Socket 4 TX Buffer Socket 4 Register Reserved Socket 3 RX Buffer Socket 3 TX Buffer Socket 3 Register Reserved Socket 2 RX Buffer Socket 2 TX Buffer Socket 2 Register Reserved Socket 1 RX Buffer Socket 1 TX Buffer Socket 1 Register Reserved Socket 0 RX Buffer Socket 0 TX Buffer Socket 0 Register Common RegisterReserved Common Register 0x0000Reserved 0x00390x003A0xFFFFSocket 0 RegisterReserved 0x00000x00300x00310xFFFFSocket 1 TX Buffer 0x00000x07FF0x08000xFFFF 0x0FFF0x1000 ...0xEFFF0xF0000xF7FF0xF800 ...Socket 7 RX Buffer ... 0x00000x07FF0x08000xFFFF 0x0FFF0x10000xEFFF0xF0000xF7FF0xF800 ... ...... 0x413C 0x00000x1000 0x08000x18000x20000x28000x30000x38000x3FFF Socket 0 TX Bufer (2KB)Socket 1 TX Buffer (2KB)Socket 2 TX Buffer (2KB)Socket 3 TX Buffer (2KB)Socket 4 TX Buffer (2KB)Socket 5 TX Buffer (2KB)Socket 6 TX Buffer (2KB)Socket 7 TX Buffer (2KB) 0x093C0x0FFF ... 0x9E2C 0x00000x1000 0x08000x18000x20000x28000x30000x38000x3FFF Socket 0 RX Buffer (2KB)Socket 1 RX Buffer (2KB)Socket 2 RX Buffer (2KB)Socket 3 RX Buffer (2KB)Socket 4 RX Buffer (2KB)Socket 5 RX Buffer (2KB)Socket 6 RX Buffer (2KB)Socket 7 RX Buffer (2KB)0x3E2C 0x0FFF Physical 16KB TX Memory
 W5500 Datasheet Version1.0. 2 (November 2013) 29 / 66 3.1 Common Register Block Common Register Block configures the general information of W5500 such as IP and MAC address. This block can be selected by the BSB[4:0] value of SPI Frame. <Table 3> defines the offset address of registers in this block. Refer to ‚Äò.1 ‚Äô for more details about each register. Table 3. Offset Address for Common Register Offset Register Offset Register Offset Register 0x0000 Mode (MR) 0x0013 0x0014 Interrupt Low Level Timer (INTLEVEL0) (INTLEVEL1) 0x0021 0x0022 0x0023 (PHAR3) (PHAR4) (PHAR5) 0x0001 0x0002 0x0003 0x0004 Gateway Address (GAR0) (GAR1) (GAR2) (GAR3) 0x0015 Interrupt (IR) 0x0024 0x0025 PPP Session Identification (PSID0) (PSID1) 0x0016 Interrupt Mask (IMR) 0x0026 0x0027 PPP Maximum Segment Size (PMRU0) (PMRU1) 0x0005 0x0006 0x0007 0x0008 Subnet Mask Address (SUBR0) (SUBR1) (SUBR2) (SUBR3) 0x0017 Socket Interrupt (SIR) 0x0018 Socket Interrupt Mask (SIMR) 0x0028 0x0029 0x002A 0x002B Unreachable IP address (UIPR0) (UIPR1) (UIPR2) (UIPR3) 0x0019 0x001A Retry Time (RTR0) (RTR1) 0x0009 0x000A 0x000B 0x000C 0x000D 0x000E Source Hardware Address (SHAR0) (SHAR1) (SHAR2) (SHAR3) (SHAR4) (SHAR5) 0x001B Retry Count (RCR) 0x002C 0x002D Unreachable Port (UPORT R0) (UPORT R1) 0x001C PPP LCP Request Timer (PTIMER) 0x002E PHY Configuration (PHYCFGR ) 0x001D PPP LCP Magic number (PMAGIC) 0x000F 0x0010 0x0011 0x0012 Source IP Address (SIPR0) (SIPR1) (SIPR2) (SIPR3) 0x002F ~ 0x0038 Reserved 0x001E 0x001F 0x0020 PPP Destination MAC Address (PHAR0) (PHAR1) (PHAR2) 0x0039 Chip version (VERSIONR) 0x003A ~ 0xFFFF Reserved 
 30 / 66 W5500 Datasheet Version1.0. 2 (November 2013) 3.2 Socket Register Block W5500 supports 8 Sockets for communication channel. Each Socket is controlled by Socket n Register Block(when 0‚â§n‚â§7). The n value of Socket n Register can be selected by BSB[4:0] of SPI Frame. <Table 4> defines the 16bits Offset Address of registers in Socket n Register Block. Refer to ‚Äò. 2‚Äô for more details about each register. Table 4. Offset Address in Socket n Register Block (0‚â§n‚â§7) Offset Register Offset Register Offset Register 0x0000 Socket n Mode (Sn_MR) 0x0010 0x0011 Socket n Destination Port (Sn_DPORT0) (Sn_DPORT1) 0x0024 0x0025 Socket n TX Write Pointer (Sn_TX_WR0) (Sn_TX_WR1) 0x0001 Socket n Command (Sn_CR) 0x0012 0x0013 Socket n Maximum Segment Size (Sn_MSSR0) (Sn_MSSR1) 0x0026 0x0027 Socket n RX Received Size (Sn_RX_RSR0) (Sn_RX_RSR1) 0x0002 Socket n Interrupt (Sn_IR) 0x0003 Socket n Status (Sn_SR) 0x0028 0x0029 Socket n RX Read Pointer (Sn_RX_RD0) (Sn_RX_RD1) 0x0014 Reserved 0x0004 0x0005 Socket n Source Port (Sn_PORT0) (Sn_PORT1) 0x0015 Socket n IP TOS (Sn_TOS) 0x002A 0x002B Socket n RX Write Pointer (Sn_RX_WR0) (Sn_RX_WR1) 0x0016 Socket n IP TTL (Sn_TTL) 0x0006 0x0007 0x0008 0x0009 0x000A 0x000B Socket n Destination Hardware Address (Sn_DHAR0) (Sn_DHAR1) (Sn_DHAR2) (Sn_DHAR3) (Sn_DHAR4) (Sn_DHAR5) 0x0017 ~ 0x001D Reserved 0x002C Socket n Interrupt Mask (Sn_IMR) 0x002D 0x002E Socket n Fragment Offset in IP header (Sn_FRAG0) (Sn_FRAG1) 0x001E Socket n Receive Buffer Size (Sn_RXBUF_SIZE) 0x001F Socket n Transmit Buffer Size (Sn_TXBUF_SIZE) 0x002F Keep alive timer (Sn_KPALVTR) 0x000C 0x000D 0x000E 0x000F Socket n Destination IP Address (Sn_DIPR0) (Sn_DIPR1) (Sn_DIPR2) (Sn_DIPR3) 0x0020 0x0021 Socket n TX Free Size (Sn_TX_FSR0) (Sn_TX_FSR1) 0x003 0 ~ 0xFFFF Reserved 0x0022 0x0023 Socket n TX Read Pointer (Sn_TX_RD0) (Sn_TX_RD1) 
 W5500 Datasheet Version1.0. 2 (November 2013) 31 / 66 3.3 Memory W5500 has one 16KB TX memory for Socket n TX Buffer Blocks and one 16KB RX memory for Socket n RX buffer Blocks. 16KB TX memory is initially allocated in 2KB size for each Socket TX Buffer Block (2KB X 8 = 16KB). The initial allocated 2KB size of Socket n TX Buffer can be re - allocated by using ‚ÄòSocket n TX Buffer Size Register (Sn_TXBUF_SIZE) ‚Äô. Once all Sn_TXBUF_SIZE registers have been configured, Socket TX Buffer is allocated with the configured size of 16KB TX Memory and is assigned sequentially from Socket 0 to Socket 7. Its physical memory address is automatically determined in 16KB TX memory. Therefore, the total sum of Sn_TXBUF_SIZE should be not exceed 16 in case of error in data transmission. The 16KB RX memory allocation method is the same as t he 16KB TX memory allocation method. 16KB RX memory is initially allocated into 2KB size for each Socket RX Buffer Block (2KB X 8 = 16KB). The initial allocated 2KB size of Socket n RX Buffer can be re -allocated by using ‚ÄòSocket n RX Buffer Size Register (Sn_RXBUF_SIZE) ‚Äô. When all Sn_RXBUF_SIZE registers have been configu red, the Socket RX Buffer is allocated with the configured size in 16KB RX Memory and is assigned sequentially from Socket 0 to Socket 7. The physical memory address of the Socket RX Buffer is automatically determined in 16KB RX memory. Therefore, the tota l sum of Sn_RXBUF_SIZE should not exceed 16, data reception error will occur if exceeded. For 16KB TX/RX memory allocation, refer to Sn_TXBUF_SIZE & Sn_RXBUF_SIZE in ‚Äò.2 ‚Äô. The Socket n TX Buffer Block allocated in 16KB TX memory is buffer for saving data to be transmitted by host. The 16bits Offset Address of Socket n TX Buffer Block has 64KB address space ranged from 0x0000 to 0xFFFF, and it is configured with reference to ‚ÄòSocket n TX Write Pointer Register (Sn_TX_WR) ‚Äô & ‚ÄòSocket n TX Read Pointer Register(Sn_RX_RD) ‚Äô. However, the 16bits Offset Address automatically convert s into the physical address to be accessible in 16KB TX memory such as Figure 20. Refer to ‚Äò.2 ‚Äô for Sn_TX_WR & Sn_TX_RD. The Socket n RX Buffer Block allocated in 16KB RX memory is buffer for saving the received data through the Ethernet. The 16bits Offset Address of Socket n RX Buffer Block has 64KB address space ranged from 0x0000 to 0xFFFF, and it is configured with reference to ‚ÄòSocket n RX RD Pointer Register (Sn_RX_RD) ‚Äô & ‚ÄòSocket n RX Write Pointer Register (Sn_RX_WR) ‚Äô. However, the 16bits Offset Address automatically convert s into the physical address to be accessible in 16KB RX memory such as Figure 20. Refer to ‚Äò.2 ‚Äô for Sn_RX_RD & Sn_RX_WR. 
 32 / 66 W5500 Datasheet Version1.0. 2 (November 2013) Register Descriptions 4 4.1 Common Registers MR (Mode Register) [R/W] [0x0000] [0x00]2 MR is used for S/W reset, ping block mode and PPPoE mode. 7 6 5 4 3 2 1 0 RST Reserved WOL PB PPPoE Reserved FARP Reserved Bit Symbol Description 7 RST If this bit is ‚Äò1‚Äô, All internal registers will be initialized. It will be automatically cleared as ‚Äò0‚Äô after S/W reset. 6 Reserved Reserved 5 WOL Wake on L AN 0: Disable WOL mode 1: Enable WOL mode If WOL mode is enabled and the received magic packet over UDP has been normally processed, the Interrupt PIN (INTn) asserts to low. When using WOL mode, the UDP Socket should be opened with any source port number. (Refer to Socket n Mode Register (Sn_MR) for opening Socket.) Notice: The magic packet over UDP supported by W5500 consists of 6 bytes synchronization stream ( ‚Äò0xFFFFFFFFFFFF ‚Äô) and 16 times Target MAC address stream in UDP payload. The options such like password are ignored. You can use any UDP source port number for WOL mode. 4 PB Ping Block Mode 0: Disable Ping block 1: Enable Ping block If the bit is ‚Äò1‚Äô, it blocks the response to a ping request. 3 PPPoE PPPoE Mode 0: Disable PPPoE mode 1: Enable PPPoE mode If you use ADSL, this bit should be ‚Äò1‚Äô. 2 Reserved Reserved 1 FARP Force ARP 2 Register Notation: [Read/Write] [ Address] [Reset value] 
 W5500 Datasheet Version1.0. 2 (November 2013) 33 / 66 0: Disable Force ARP mode 1: Enable Force ARP mode In Force ARP mode, It forces on sending ARP Request whenever data is sent. 0 Reserved Reserved GAR (Gateway IP Address Register) [R/W] [0x0001 ‚Äì 0x0004] [0x00] GAR configures the default gateway address. Ex) In case of ‚Äú192.168.0.1‚Äù 0x0001 0x0002 0x0003 0x0004 192 (0xC0) 168 (0xA8) 0 (0x00) 1 (0x01) SUBR (Subnet Mask Register) [R/W] [0x0005 ‚Äì 0x0008] [0x00] SUBR configures the subnet mask address. Ex) In case of ‚Äú255.255.255.0‚Äù 0x0005 0x0006 0x0007 0x0008 255 (0xFF) 255 (0xFF) 255 (0xFF) 0 (0x00) SHAR (Source Hardware Address Register) [R/W] [0x0009 ‚Äì 0x000E] [0x00] SHAR configures the source hardware address. Ex) In case of ‚Äú00.08.DC.01.02.03‚Äù 0x0009 0x000A 0x000B 0x000C 0x000D 0x000E 0x00 0x08 0xDC 0x01 0x02 0x03 SIPR (Source IP Address Register) [R/W] [0x000F ‚Äì 0x0012] [0x00] SIPR configures the source IP address. Ex) In case of ‚Äú192.168.0.2‚Äù 0x000F 0x0010 0x0011 0x0012 192 (0xC0) 168 (0xA8) 0 (0x00) 2 (0x02) 
 34 / 66 W5500 Datasheet Version1.0. 2 (November 2013) INTLEVEL (Interrupt Low Level Timer Register) [R/W] [0x0013 ‚Äì 0x0014] [0x0000] INTLEVEL configures the Interrupt Assert Wait Time (IAWT). When the next interrupt occurs, Interrupt PIN (INTn ) will assert to low after INTLEVEL time. ùêºùê¥ùëäùëá = (ùêºùëÅùëáùêøùê∏ùëâùê∏ùêø +1)√óùëÉùêøùêøùê∂ùêøùêæ√ó4 (when INTLEVEL > 0) Figure 21. INTLEVEL Timing a. When Timeout Interrupt of Socket 0 is occurred, S0_IR[3] & SIR[0] bit set as ‚Äò1‚Äô and then INTn PIN is asserted to low. b. When the connection interrupt of Socket 1 is occurred before the previous interrupt processing is not completed, S1_IR[0] & SIR[1] bits set as ‚Äò1‚Äô and INTn PIN is still low. c. If the host process ed the previous interrupt completely by clearing the S0_I R[3] bit, INTn PIN is de -asserted to high but S1_IR[0] & SIR[1] is still set as ‚Äò1‚Äô. d. Although S1_IR[0] & SIR[1] bit is set as ‚Äò1‚Äô, the INTn can‚Äôt be asserted to low during INTLEVEL time. After the INTLEVE L time expire s, the INTn will be asserted to low. PLL_CLK SIR S0_IR S1_IR0x0000 0x0001 0x0002 0x04 0x00 0x010x00 0x001 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 0x0003 INTna.b. c. d. IAWT
 W5500 Datasheet Version1.0. 2 (November 2013) 35 / 66 IR (Interrupt Register) [R /W] [0x0015] [0x00] IR indicates the interrupt status. Each bit of IR can be cleared when the host writes ‚Äò1‚Äô value to each bit. If IR is not equal to ‚Äò0x00‚Äô, INTn PIN is asserted low until it is ‚Äò0x00‚Äô. 7 6 5 4 3 2 1 0 CONFLICT UNREACH PPPoE MP Reserved Reserved Reserved Reserved Bit Symbol Description 7 CONFLICT IP Conflict Bit is set as ‚Äò1‚Äô when own source IP address is same with the sender IP address in the received ARP request. 6 UNREACH Destination unreachable When receiving the ICMP (Destination port unreachable) packet, this bit is set as ‚Äò1‚Äô. When this bit is ‚Äò1‚Äô, Destination Information such as IP address and Port number may be checked with the corresponding UIPR & UPORTR. 5 PPPoE PPPoE Connection Close When PPPoE is disconnect ed during PPPoE mode, this bit is set. 4 MP Magic Packet When WOL mode is enabled and receives the magic packet over UDP, this bit is set. 3~0 Reserved Reserved 
 36 / 66 W5500 Datasheet Version1.0. 2 (November 2013) IMR (Interrupt Mask Register) [R/W][0x0016][0x00] IMR is used to mask interrupts. Each bit of IMR corresponds to each bit of IR. When a bit of IMR is ‚Äò1‚Äô and the corresponding bit of IR is ‚Äò1‚Äô, an interrupt will be issued. In other words, if a bit of IMR is ‚Äò0‚Äô, an interrupt will not be issued even if the corresponding bit of IR is ‚Äò1‚Äô. 7 6 5 4 3 2 1 0 IM_IR7 IM_IR6 IM_IR5 IM_IR4 Reserved Reserved Reserved Reserved Bit Symbol Description 7 IM_IR7 IP Conflict Interrupt Mask 0: Disable IP Conflict Interrupt 1: Enable IP Conflict Interrupt 6 IM_IR6 Destination unreachable Interrupt Mask 0: Disable Destination unreachable Interrupt 1: Enable Destination unreachable Interrupt 5 IM_IR5 PPPoE Close Interrupt Mask 0: Disable PPPoE Close Interrupt 1: Enable PPPoE Close Interrupt 4 IM_IR4 Magic Packet Interrupt Mask 0: Disable Magic Packet Interrupt 1: Enable Magic Packet Interrupt 3~0 Reserved Reserved 
 W5500 Datasheet Version1.0. 2 (November 2013) 37 / 66 SIR (Socket Interrupt Register) [R/W] [0x0017] [0x00] SIR indicates the interrupt status of Socket. Each bit of SIR be still ‚Äò1‚Äô until Sn_IR is cleared by the host. If Sn_IR is not equal to ‚Äò0x00‚Äô, the n -th bit of SIR is ‚Äò1‚Äô and INTn PIN is asserted until SIR is ‚Äò0x00‚Äô. 7 6 5 4 3 2 1 0 S7_INT S6_INT S5_INT S4_INT S3_INT S2_INT S1_INT S0_INT Bit Symbol Description 7 ~ 0 Sn_INT When the interrupt of Socket n occurs, the n -th bit of SIR becomes ‚Äò1‚Äô. SIMR (Socket Interrupt Mask Register) [R/W] [0x0018] [0x00] Each bit of SIMR corresponds to each bit of SIR. When a bit of SIMR is ‚Äò1‚Äô and the corresponding bit of SIR is ‚Äò1‚Äô, Interrupt will be issued. In other words, if a bit of SIMR is ‚Äò0‚Äô, an interrupt will be not issued even if the corresponding bit of SIR is ‚Äò 1‚Äô. 7 6 5 4 3 2 1 0 S7_IMR S6_IMR S5_IMR S4_IMR S3_IMR S2_IMR S1_IMR S0_IMR Bit Symbol Description 7 ~ 0 Sn_IMR Socket n(Sn_INT) Interrupt Mask 0: Disable Socket n Interrupt 1: Enable Socket n Interrupt 
 38 / 66 W5500 Datasheet Version1.0. 2 (November 2013) RTR (Retry Time -value Register) [R/W] [0x0019 ‚Äì 0x001A] [0x07D0] RTR configures the retransmission timeout period. The unit of timeout period is 100us and the default of RTR is ‚Äò0x07D0‚Äô or ‚Äò2000‚Äô. And so the default timeout period is 200ms(100us X 2000). During the time configured by RTR, W5 500 wait s for the peer response to the packet that is transmitted by Sn_CR(CONNECT, DISCON, CLOSE, SEND, SEND_MAC, SEND_KEEP command). If the peer does not respon d within the RTR time, W5500 retransmits the packet or issues timeout. Ex) When timeout -period is set as 400ms, RTR = (400ms / 1ms) X 10 = 4000(0x0FA0) 0x001 9 0x001 A 0x0F 0xA0 RCR (Retry Count Register) [R/W] [0x00 1B] [0x08] RCR configures the number of time of retransmission. When retransmission occurs as many as ‚ÄòRCR+1‚Äô, Timeout interrupt is issued (Sn_IR[TIMEOUT] = ‚Äò1‚Äô). Ex) RCR = 0x0007 0x001 B 0x07 The timeout of W5500 can be configurable with RTR and RCR. W5500 has two kind timeout such as Address Resolution Protocol (ARP) and TCP retransmission. At the ARP (Refer to RFC 826, http://www.ietf.org/rfc.html ) retransmission timeout, W5500 automatically sends ARP -request to the peer‚Äôs IP address in order to acquire MAC address information (used for communicat ion of IP, UDP, or TCP). While waiting for ARP -response from the peer, if there is no response during the configured RTR time, a temporary timeout is occurred and ARP -request is retransmitted. It is repeated as many as ‚ÄòRCR + 1‚Äô times. Even after the ARP-request retransmissions are repeated as ‚ÄòRCR+1‚Äô and there is no response to the ARP -request, the final timeout is occurred and Sn_IR(TIMEOUT) becomes ‚Äò1‚Äô. The time of final timeout ( ARP TO) of ARP - request is as below. ùê¥ùëÖùëÉ ùëáùëÇ= (ùëÖùëáùëÖ √ó0.1ùëöùë†)√ó (ùëÖùê∂ùëÖ +1) At the TCP packet retransmission timeout, W5500 transmits TCP packets (SYN, FIN, RST, DATA packets) and waits for the acknowledgement (ACK) during the configured RTR time and RCR. If there is no ACK from the peer, a temporary timeout occurs and 
 W5500 Datasheet Version1.0. 2 (November 2013) 39 / 66 the TCP pac ket is retransmitted. The retransmission is repeated as many as ‚ÄòRCR+1‚Äô. Even after TCP retransmission is repeated as ‚ÄòRCR+1‚Äô and there is no response to the TCP retransmission, the final timeout is occurred and Sn_IR(TIMEOUT) becomes ‚Äò1‚Äô. The time of fina l timeout (TCPTO) of TCP retransmission is as below. ùëáùê∂ùëÉ ùëáùëÇ= (‚àë(ùëÖùëáùëÖ √ó2ùëÅ) + ((ùëÖùê∂ùëÖ ‚àíùëÄ)√ó ùëÖùëáùëÖ ùëÄùê¥ùëã)ùëÄ ùëÅ=0)√ó0.1ùëöùë† N: Retransmission count, 0 ‚â§N ‚â§ M M: Minimum value when RTR x 2(M+1) > 65535 and 0 ‚â§ M ‚â§ RCR RTRMAX: RTR x 2M Ex) When RTR = 2000(0x07D0), RCR = 8(0x0008), ARP TO = 2000 X 0.1ms X 9 = 1800ms = 1.8s TCP TO = (0x07D0+0x0FA0+0x1F40+0x3E80+0x7D00+0xFA00+0xFA00+0xFA00+0xFA00) X 0.1ms = (2000 + 4000 + 8000 + 16000 + 32000 + ((8 - 4) X 64000)) X 0.1ms = 318000 X 0.1ms = 31.8s PTIMER (PPP Link Control Protocol Request Timer Register) [R/W] [0x001C] [0x0028] PTIMER configures the time for sending LCP echo request. The unit of time is 25ms. Ex) in case that PTIMER is 200, 200 * 25(ms) = 5000(ms) = 5 seconds PMAGIC (PPP Link Control Protocol Magic number Register) [R/W] [0x001D] [0x00] PMAGIC configures the 4bytes magic number to be used in LCP echo request. Ex) PMAGIC = 0x0 1 0x001 D 0x01 LCP Magic number = 0x01010101 
 40 / 66 W5500 Datasheet Version1.0. 2 (November 2013) PHAR (Destination Har dware Address Register in PPPoE mode) [R/W] [0x001E -0x0023] [0x0000] PHAR should be written to the PPPoE server hardware address acquired in PPPoE connection process Ex) In case that destination hardware address is 00:08: DC:12:34:56 0x001E 0x001F 0x0020 0x0021 0x0022 0x0023 0x00 0x08 0xDC 0x12 0x34 0x56 PSID (Session ID Register in PPPoE mode) [R /W] [0x0024 -0x0025] [0x0000] PSID should be written to the PPPoE sever session ID acquired in PPPoE connection process. Ex) In case that Session ID is 0x1234 0x002 4 0025 18 (0x12) 52(0x34) PMRU (Maximum Receive Unit in PPPoE mode) [R/W] [0x0026 -0x0027] [0xFFFF] PMRU configures the maximum receive unit of PPPoE. Ex) in case that maximum receive unit in PPPoE is 0x1234 0x002 6 0027 18 (0x12) 52 (0x34) 
 W5500 Datasheet Version1.0. 2 (November 2013) 41 / 66 UIPR (Unreachable IP Address Register) [R] [0x0028 -0x002B] [0x00000000] UPORTR ( Unreachable Port Register ) [R] [ 0x002C -0x002D ] [0x0000] W5500 receives an ICMP packet(Destination port unreachable) when data is sent to a port number which socket is not open and UNREACH bit of IR becomes ‚Äò1‚Äô and UIPR & UPORT R indicates the destination IP address & port number respectively. Ex) In case of ‚Äú192.168.0.11‚Äù 0x0028 0x0029 0x002A 0x002B 192 (0xC0) 168 (0xA8) 0 (0x00) 11 (0x0E) Ex) In case of ‚Äú0x1234‚Äù 0x002C 002D 18 (0x12) 52(0x34) 
 42 / 66 W5500 Datasheet Version1.0. 2 (November 2013) PHYCFGR (W5500 PHY Configuration Register) [R/W] [0x002E] [0b10111XXX ] PHYCFGR configures PHY operation mode and resets PHY. In addition, PHYCFGR indicates the status of PHY such as duplex, Speed, Link. Bit Symbol Description 7 RST Reset [R/W] When this bit is ‚Äò0‚Äô, internal PHY is reset. After PHY reset, it should be set as ‚Äò1‚Äô. 6 OPMD Configure PHY Operation Mode 1: Configure with OPMDC[2:0] in PHYCFGR 0: Configure with the H/W PINs(PMODE[2:0]) This bit configures PHY operation mode with OPMDC[2:0] bits or PMODE[2:0] PINs. When W5500 is reset by POR or RSTn PIN, PHY operation mode is configured with PMODE[2:0] PINs by default. After POR or RSTn reset, user can re -configure PHY operation mode with OPMDC[2:0]. If user wants to re-configure with PMDC[2:0], it should reset PHY by setting the RST bit to ‚Äò0‚Äô after the user configures this bit as ‚Äò1‚Äô and OPMDC[2:0]. 5~3 OPMDC Operation Mode Configuration Bit [R/W] These bits select the operation mode of PHY such as following table. 5 4 3 Description 0 0 0 10BT Half -duplex, Auto -negotiation disabled 0 0 1 10BT Full -duplex, Auto -negotiation disabled 0 1 0 100BT Half -duplex, Auto -negotiation disabled 0 1 1 100BT Full -duplex, Auto -negotiation disabled 1 0 0 100BT Half -duplex, Auto -negotiation enabled 1 0 1 Not used 1 1 0 Power Down mode 1 1 1 All capable, Auto -negotiation enabled 2 DPX Duplex Status [Read Only] 1: Full duplex 0: Half duplex 1 SPD Speed Status [Read Only] 1: 100Mpbs based 0: 10Mpbs based 0 LNK Link Status [Read Only] 1: Link up 0: Link down 
 W5500 Datasheet Version1.0. 2 (November 2013) 43 / 66 VERSIONR (W5500 Chip Version Register) [R] [0x0039] [0x04] VERSIONR always indicates the W5500 version as 0x04. 
 44 / 66 W5500 Datasheet Version1.0. 2 (November 2013) 4.2 Socket Registers Sn3_MR (Socket n Mode Register) [R/W] [0x0000] [0x00] Sn_MR configures the option or protocol type of Socket n. 7 6 5 4 3 2 1 0 MULTI/ MFEN BCASTB ND / MC /MMB UCASTB MIP6B P3 P2 P1 P0 Bit Symbol Description 7 MULTI/ MFEN Multicasting in UDP mode 0: disable Multicasting 1: enable Multicasting This bit is applied only during UDP mode(P[3:0] = ‚Äò0010‚Äô). To use multicasting, Sn_DIPR & Sn_DPORT should be respectively configured with the multicast group IP address & port number before Socket n is opened b y OPEN command of Sn_CR MAC Filter Enable in MACRAW mode 0: disable MAC Filtering 1: enable MAC Filtering This bit is applied only during MACRAW mode(P[3:0] = ‚Äò0100‚Äô). When set as ‚Äò1‚Äô, W5500 can only receive broadcasting packet or packet sent to itself. When this bit is ‚Äò0‚Äô, W5500 can receive all packets on Ethernet. If user wants to implement Hybrid TCP/IP stack, it is recommended that this bit is set as ‚Äò1‚Äô for reducing host overhead to process the all received packets. 6 BCAST B Broadcast Blocking in MACRAW and UDP mode 0: disable Broadcast Blocking 1: enable Broadcast Blocking This bit blocks to receive broadcasting packet during UDP mode(P[3:0] = ‚Äò0010‚Äô). In addition, This bit does when MACRAW mode(P[3:0] = ‚Äò0100‚Äô) 5 ND/MC/ MMB Use No Delayed ACK 0: Disable No Delayed ACK option 1: Enable No Delayed ACK option This bit is applied only during TCP mode (P[3:0] = ‚Äò0001‚Äô). When this bit is ‚Äò1‚Äô, It sends the ACK packet without delay as soon as a 3n is Socket number (0, 1, 2, 3, 4, 5, 6, 7). n is set ‚ÄòSNUM[2:0]‚Äô in Control Bits sets. 
 W5500 Datasheet Version1.0. 2 (November 2013) 45 / 66 Data packet is received f rom a peer. When this bit is ‚Äò0‚Äô, It sends the ACK packet after waiting for the timeout time configured by RTR. Multicast 0: using IGMP version 2 1: using IGMP version 1 This bit is applied only during UDP mode(P[3:0] = ‚Äò0010‚Äô) and MULTI = ‚Äò1‚Äô. It conf igures the version for IGMP messages (Join/Leave/Report). Multicast Blocking in MACRAW mode 0: disable Multicast Blocking 1: enable Multicast Blocking This bit is applied only when MACRAW mode(P[3:0] = ‚Äò0100‚Äô). It blocks to receive the packet with multicast MAC address. 4 UCASTB MIP6B UNICAST Blocking i n UDP mode 0: disable Unicast Blocking 1: enable Unicast Blocking This bit block s receiving the unicast packet during UDP mode(P[3:0] = ‚Äò0010‚Äô) and MULTI = ‚Äò1‚Äô. IPv6 packet Blocking in MACRAW mode 0: disable IPv6 Blocking 1: enable IPv6 Blocking This bit is applied only during MACRAW mode (P[3:0] = ‚Äò0100‚Äô). It blocks to receiving the IPv6 packet. 3 P3 Protocol This configures the protocol mode of Socket n. P3 P2 P1 P0 Meaning 0 0 0 0 Closed 0 0 0 1 TCP 0 0 1 0 UDP 0 1 0 0 MACRAW * MACRAW mode should be only used in Socket 0. 2 P2 1 P1 0 P0 
 46 / 66 W5500 Datasheet Version1.0. 2 (November 2013) Sn_CR ( Socket n Command Register) [R/W] [0x0001] [0x00] This is used to set the command for Socket n such as OPEN, CLOSE, CONNECT, LISTEN, SEND, and RECEIVE. After W5500 accepts the command, the Sn_CR register is automatically cleared to 0x00. Even though Sn_CR is cleared to 0x00, the command is still being processed. To check whether the command is completed or not, please check the Sn_IR or Sn_SR. Value Symbol Description 0x01 OPEN Socket n is initialized and opened according to the protocol selected in Sn_MR (P3:P0). The table below shows the value of Sn_SR corresponding to Sn_MR. Sn_MR (P[3:0]) Sn_SR Sn_MR_CLOSE (‚Äò0000‚Äô) - Sn_MR_TCP (‚Äò0001‚Äô) SOCK_INIT (0x13) Sn_MR_UDP (‚Äò0010‚Äô) SOCK_UDP (0x22) S0_MR_MACRAW (‚Äò0100‚Äô) SOCK_MACRAW (0x02). 0x02 LISTEN This is valid only in TCP mode (Sn_MR(P3:P0) = Sn_MR_TCP). In this mode, Socket n operates as a ‚ÄòTCP server‚Äô and waits for connection -request (SYN packet) from any ‚ÄòTCP client‚Äô. The Sn_SR changes the state from SOCK_INIT to SOCKET_LISTEN. When a ‚ÄòTCP client ‚Äô connection request is successfully established, the Sn_SR changes from SOCK_LISTEN to SOCK_ESTABLISHED and the Sn_IR(0) becomes ‚Äò1‚Äô. But when a ‚ÄòTCP client‚Äô connection request is failed, Sn_IR(3) becomes ‚Äò1‚Äô and the status of Sn_SR changes to SOCK_CLOSED. 0x04 CONNECT This is valid only in TCP mode and operates when Socket n acts as ‚ÄòTCP client‚Äô. To connect, a connect -request (SYN packet) is sent to ‚ÄòTCP server‚Äô configured by Sn_DIPR & Sn_DPORT(destination address & port). If the connec t-request is successful, the Sn_SR is changed to SOCK_ESTABLISHED and the Sn_IR(0) becomes ‚Äò1‚Äô. The connect -request fails in the following three cases. 1. When a ARP TO occurs (Sn_IR(3)=‚Äò1‚Äô) because the destination hardware address is not acquired through the ARP -process. 2. When a SYN/ACK packet is not received and TCP TO (Sn_IR(3) = ‚Äò1 ) 3. When a RST packet is received instead of a SYN/ACK packet. 
 W5500 Datasheet Version1.0. 2 (November 2013) 47 / 66 In these cases, Sn_SR is changed to SOCK_CLOSED. 0x08 DISCON Valid only in TCP mode. Regardless of ‚ÄòTCP server‚Äô or ‚ÄòTCP client‚Äô, the DISCON command processes the disconnect -process (‚ÄòActive close‚Äô or ‚ÄòPassive close‚Äô). Active close: it transmits disconnect -request(FIN packet) to the connected peer Passive close: When FIN packet is received from peer, a FIN packet is replied back to the peer. When the disconnect -process is successful (that is, FIN/ACK packet is received successfully), S n_SR is changed to SOCK_CLOSED. Otherwise, TCP TO occurs (Sn_IR(3)=‚Äò1)= and then Sn_SR is changed to SOCK_CLOSED. cf> If CLOSE is used instead of DISCON, only Sn_SR is changed to SOCK_CLOSED without disconnect -process. If a RST packet is received from a peer during communication, Sn_SR is unconditionally changed to SOCK_CLOSED. 0x10 CLOSE Close Socket n. Sn_SR is changed to SOCK_CLOSED. 0x20 SEND SEND transmits all the data in the Socket n TX buffer. For more details, please refer to Socket n TX Free Size Register (Sn_TX_FSR), Socket n, TX Write Pointer Register(Sn_TX_WR), and Socket n TX Read Pointer Register(Sn_TX_RD). 0x21 SEND_MAC Valid only in UDP mode. The basic operation is same as SEND. Normally SEND transmits data after destination hardware address is acquired by the automatic ARP-process(Address Resolution Protocol). But SEND_MAC transmits data without the automatic ARP -process. In this case, the destination hardware address is acquired from Sn_DHAR configured by host, instead of APR -process. 0x22 SEND_KEEP Valid only in TCP mode. It checks the connection status by sending 1byte keep -alive packet. If the peer cannot respon d to the keep -alive packet during timeout time, the connection is terminated and the timeout interrupt will occur. 
 48 / 66 W5500 Datasheet Version1.0. 2 (November 2013) 0x40 RECV RECV completes the processing of the received data in Socket n RX Buffer by using a RX read pointer register (Sn_RX_RD). For more detail s, refer to Socket n RX Received Size Register (Sn_RX_RSR), Socket n RX Write Pointer Register (Sn_RX_WR), and Socket n RX Read Pointer Register (Sn_RX_RD). Sn_IR (Socket n Interrupt Register) [R] [0x0002] [0x00] Sn_IR indicates the status of Socket Interrupt such as establishment, termination, receiving data, timeout). When an interrupt occurs and the correspond ing bit of Sn_IMR is ‚Äò1‚Äô, the corresponding bit of Sn_IR becomes ‚Äò1‚Äô. In order to clear the Sn_IR bit, the host should write the bit to ‚Äò1‚Äô. 7 6 5 4 3 2 1 0 Reserved Reserved Reserved SEND_OK TIMEOUT RECV DISCON CON Bit Symbol Description 7~5 Reserved Reserved 4 SEND_OK Sn_IR(SENDOK) Interrupt This is issued when SEND command is completed. 3 TIMEOUT Sn_IR(TIMEOUT) Interrupt This is issued when ARP TO or TCP TO occurs. 2 RECV Sn_IR(RECV) Interrupt This is issued whenever data is received from a peer. 1 DISCON Sn_IR(DISCON) Interrupt This is issued when FIN or FIN/ACK packet is received from a peer. 0 CON Sn_IR(CON) Interrupt This is issued one time when the connection with peer is successful and then Sn_SR is changed to SOCK_ESTABLISHED. 
 W5500 Datasheet Version1.0. 2 (November 2013) 49 / 66 Sn_SR ( Socket n Status Register) [R] [ 0x0003 ] [0x00] Sn_SR indicates the status of Sock et n. The status of Socket n is changed by Sn_CR or some special control packet as SYN, FIN packet in TCP. Value Symbol Description 0x00 SOCK_CLOSED This indicates that Socket n is released. When DICON, CLOSE command is ordered, or when a timeout occurs, it is changed to SOCK_CLOSED regardless of previous status. 0x13 SOCK_INIT This indicates Socket n is opened with TCP mode. It is changed to SOCK_INIT when Sn_MR (P[3:0]) = ‚Äò0001‚Äô and OPEN command is ordered. After SOCK_INIT, user can use LISTEN /CONNECT command. 0x14 SOCK_LISTEN This indicates Socket n is operating as ‚ÄòTCP server‚Äô mode and waiting for connection -request (SYN packet) from a peer (‚ÄòTCP client‚Äô). It will change to SOCK_ESTALBLISHED when the connection - request is successfully accepted. Otherwise it will change to SOCK_CLOSED after TCPTO occurred (Sn_IR(TIMEOUT) = ‚Äò1‚Äô). 0x17 SOCK_ESTABLISHED This indicates the status of the connection of Socket n. It changes to SOCK_ESTABLISHED when the ‚ÄòTCP SERVER‚Äô processed the SYN packet from the ‚ÄòTCP CLIENT‚Äô during SOCK_LISTEN, or when the CONNECT command is successful. During SOCK_ESTABLISHED, DATA packet can be transferred using SEND or RECV command. 0x1C SOCK_CLOSE_WAIT This indicates Socket n received the disconnect -request (FIN packet) from the connected peer. This is half -closing status, and data can be transferred. For full -closing, DISCON command is used. But For just -closing, CLOSE command is used. 0x22 SOCK_UDP This indicates Socket n is opened in UD P mode(Sn_MR(P[3:0]) = ‚Äò0010‚Äô). It changes to SOCK_ UDP when Sn_MR(P[3:0]) = ‚Äò0010‚Äô) and OPEN command is ordered. Unlike TCP mode, data can be transfered without the connection -process. 
 50 / 66 W5500 Datasheet Version1.0. 2 (November 2013) 0x42 SOCK_MACRAW This indicates Socket 0 is opened in MACRAW mode (S0_MR(P[3:0]) = ‚Äò0100‚Äô)and is valid only in Socket 0. It changes to SOCK_MACRAW when S0_MR(P[3:0] = ‚Äò0100‚Äô and OPEN command is ordered. Like UDP mode socket, MACRAW mode Socket 0 can transfer a MAC packet (Ethernet frame) without the connection - process. The following table show s a temporary status indicated during changing the status of Socket n. Value Symbol Description 0x15 SOCK_SYNSENT This indicates Socket n sent the connect -request packet (SYN packet) to a peer. It is temporarily shown when Sn_SR is changed from SOCK_INIT to SOCK_ESTABLISHED by CONNECT command. If connect -accept(SYN/ACK packet) is received from the peer at SOCK_SYNSENT, it changes to SOCK_ESTABLISHED. Otherwise, it changes to SOCK_CLOSED after TCPTO (Sn_IR[TIMEOUT] = ‚Äò1‚Äô) is occur red. 0x16 SOCK_SYNRECV It indicates Socket n successfully received the connect - request packet (SYN packet) from a peer. If socket n sends the response (SYN/ACK packet) to the peer successfully, it changes to SOCK_ESTABLISHED. If not, it changes to SOCK_CLOSED after timeout occurs (Sn_IR[TIMEOUT] = ‚Äò1‚Äô). 0x18 SOCK_FIN_WAIT These indicate Socket n is closing. These are shown in disconnect -process such as active -close and passive -close. When Disconnect -process is successfully completed, or when timeout occurs, these change to SOCK_CLOSED. 0x1A SOCK_CLOSING 0X1B SOCK_TIME_WAIT 0X1D SOCK_LAST_ACK This indicates Socket n is waiting for the response (FIN/ACK packet) to the disconnect -request (FIN packet) by passive - close. It changes to SOCK_CLOSED when Socket n received the response successfully, or when timeout occurs (Sn_IR[TIMEOUT] = ‚Äò1‚Äô). 
 W5500 Datasheet Version1.0. 2 (November 2013) 51 / 66 Sn_PORT ( Socket n Source Port Register) [R/W] [ 0x0004 -0x0005 ] [0x0000] Sn_PORT configures the source port number of Socket n. It is valid when Socket n is used in TCP/ UDP mode. It should be set before OPEN command is ordered. Ex) In case of Socket 0 Port = 5000(0x1388), configure as below, 0x0004 0x0005 0x13 0x88 Sn_DHAR ( Socket n Destination Hardware Address Register) [R/W] [0x0006 -0x000B] [0xFFFFFFFFFFFF] Sn_DHAR configures the destination hardware address of Socket n when using SEND_MAC command in UDP mode or it indicates that it is acquired in ARP -process by CONNECT/SEND command. Ex) In case of Socket 0 Destination Hardware address = 08.DC.00.01.02.10, config ure as below. 0x0006 0x0007 0x0008 0x0009 0x000A 0x000B 0x08 0xDC 0x00 0x01 0x02 0x0A 
 52 / 66 W5500 Datasheet Version1.0. 2 (November 2013) Sn_DIPR ( Socket n Destination IP Address Register) [R/W] [0x000C -0x000F] [0x00000000] Sn_DIPR configures or indicates the destination IP address of Socket n. It is valid when Socket n is used in TCP/UDP mode. In TCP client mode, it configures an IP address of ‚ÄòTCP server‚Äô before CONNECT command. In TCP server mode, it indicates an IP address of ‚ÄòT CP client‚Äô after successfully establishing connection. In UDP mode, it configures an IP address of peer to be received the UDP packet by SEND or SEND_MAC command. Ex) In case of Socket 0 Destination IP address = 192.168.0.11, configure as below. 0x000C 0x000D 0x000E 0x000F 192 (0xC0) 168 (0xA8) 0 (0x00) 11 (0x0B) Sn_DPORT ( Socket n Destination Port Register) [R/W] [0x0010 -0x0011] [0x00] Sn_DPORT configures or indicates the destination port number of Socket n. It is valid when Socket n is used in TCP/UDP mode. In TCP client mode, it configures the listen port number of ‚ÄòTCP server‚Äô before CONNECT command. In TCP server mode, it indicates the port number of ‚ÄòTCP client ‚Äô after successfully establishing connection. In UDP mode, it configures the port number of peer to be transmitted the UDP packet by SEND/SEND_MAC command. Ex) In case of Socket 0 Destination Port = 5000(0x1388), configure as below, 0x0010 0x0011 0x13 0x88 
 W5500 Datasheet Version1.0. 2 (November 2013) 53 / 66 Sn_MSS R (Socket n Maximum Segment Size Register) [R/W] [0x0012 -0x0013] [0x0000] Sn_MSSR configures or indicates the MTU(Maximum Transfer Unit) of Socket n. The default MTU is valid when Socket n is used in TCP / UDP mode. However, when in PPPoE mode(MR[PPPoE] = ‚Äò1‚Äô), it is determined within PPPoE MTU. Mode Normal (MR(PPPoE)=‚Äò0‚Äô) PPPoE (MR(PPPoE)=‚Äò1‚Äô) Default MTU Range Default MTU Range TCP 1460 1 ~ 1460 1452 1 ~ 1452 UDP 1472 1 ~ 1472 1464 1 ~ 1464 MACRAW 1514 When Socket n is used in MACRAW mode, the default MTU is applied because the MTU is not processed internally. Therefore, when transmitting the data bigger than default MTU, the host should manually divide the data into the unit of default MTU. When Socket n is used in TCP/UDP mode, and transmitting data bigger than MTU, the data is automatically divided into the unit of MTU. In UDP mode, because there is no such connection -process like in TCP mode, the configured MTU is used. When transmitting data to a peer with the different MTU size, the ICMP(Fragment MTU) packet might be received. In this case, IR(FMTU) becomes ‚Äò1‚Äô and the peer information such as the MTU size and IP address is indicated from FMTUR and UIPR respectively. If IR[MTU] = ‚Äò1‚Äô, user cannot transmit data to the peer. To resume the communication with peer, do as follow ed. 1. Close the Socket n by CLOSE command. 2. Set Sn_MSS to the indicated MTU from FMTUR 3. Open the Socket n by OPEN com mand 4. Resume the communication with the peer. Ex) In case of Socket 0 MSS = 1460 (0x05B4), configure as below, 0x0012 0x0013 0x05 0xB4 Sn_TOS ( Socket n IP Type of Service Register) [R/W] [0x0015] [0x00] Sn_TOS configures the TOS(Type Of Service field in IP Header) of Socket n. It is set before OPEN command. For more the detail s, refer to http://www.iana.org/assignments/ip -parameters. 54 / 66 W5500 Datasheet Version1.0. 2 (November 2013) Sn_TTL ( Socke t n TTL Register) [R/W] [0x0016] [0x80] Sn_TTL configures the TTL(Time To Live field in IP header) of Socket n. It is set before OPEN command. For more the detail s, refer to http://www.iana.org/ assignments/ip -parameters. Sn_RXBUF_SIZE ( Socket n RX Buffer Size Register) [R/W] [0x001E] [0x02] Sn_RXBUF_SIZE configures the RX buffer block size of Socket n. Socket n RX Buffer Block size can be configured with 1,2,4,8, and 16 Kbytes. If a different size is configured, the data cannot be normally received from a peer. Although Socket n RX Buffer Block size is initially configured to 2Kbytes, user can re-configur e its size using Sn_RXBUF_SIZE. The total sum of Sn_RXBUF_SIZE cannot be exceed 16Kbytes. W hen exceeded, the data reception error is occurred. When all Sn_RXBUF_SIZE have been configured, Socket n RX Buffer is allocated with the configured size in 16KB RX Memory and is assigned sequentially from Socket 0 to Socket 7. Socket n RX Buffer Block can be accessible with the 16bits Offset Address ranged from 0x0000 to 0xFFFF regardless of the configured size. (Refer to Sn_RX_RD & Sn_RX_WR). Value (dec) 0 1 2 4 8 16 Buffer size 0KB 1KB 2KB 4KB 8KB 16KB Ex) Socket 0 RX Buffer Size = 8KB 0x001E 0x08 Sn_TXBUF_SIZE ( Socket n TX Buffer Size Register) [R/W] [0x001F] [0x02] Sn_TXBUF_SIZE configures the TX buffer block size of Socket n. Socket n TX Buffer Block size can be configured with 1,2,4,8, and 16 Kbytes. If a different size is configured, the data can‚Äôt be normally transmitted to a peer. Although Socket n TX Buffer Block size is initially configured to 2Kbytes, user can be re -configur e its size using Sn_TXBUF_SIZE. The total sum of Sn_TXBUF_SIZE cannot be exceed 16Kbyte s. When exceeded, the data transmission error is occurred. When all Sn_TXBUF_SIZE have been configured, Socket n TX Buffer is allocated with the configured size in 16KB TX Memory and is assigned sequentially from Socket 0 to Socket 7. 
 W5500 Datasheet Version1.0. 2 (November 2013) 55 / 66 Socket n TX Buffer B lock can be accessible with 16bits Offset Address ranged from 0x0000 to 0xFFFF regardless of the configured size. (Refer to Sn_TX_WR & Sn_TX_RD). Value (dec) 0 1 2 4 8 16 Buffer size 0KB 1KB 2KB 4KB 8KB 16KB Ex) Socket 0 TX Buffer Size = 4KB 0x001F 0x04 Sn_TX_FSR ( Socket n TX Free Size Register) [R] [0x0020 -0x0021] [0x0800] Sn_TX_FSR indicates the free size of Socket n TX Buffer Block. It is initialized to the configured size by Sn_TXBUF_SIZE. Data bigger than Sn_TX_FSR should not be saved in the Socket n TX Buffer because the bigger data overwrites the previous saved data not yet sent. Therefore, check before saving the data to the Socket n TX Buffer, and if data is equal or smaller than its checked size, transmit the data with SEND/SEND_MAC command after saving the data in Socket n TX buffer. But, if data is bigger than its checked size, transmit the data after dividing into the checked size and saving in the Socket n TX buffer. If Sn_MR(P[3:0]) is not TCP mode(‚Äò0001‚Äô), it is automatically calculated as the difference between ‚ÄòSocket n TX Write Pointer (Sn_TX_WR)‚Äô and ‚ÄòSocket n TX Read Pointer (Sn_TX_RD)‚Äô. If Sn_MR(P[3:0]) is TCP mode(‚Äò0001‚Äô), it is automatically calculated as the difference between Sn_TX_ WR and the internal ACK pointer which indicates the point of data is received already by the connected peer. Ex) In case of 2048(0x0800) in S0_TX_FSR, 0x0020 0x0021 0x08 0x00 Sn_TX_RD ( Socket n TX Read Pointer Register) [R] [0x0022 -0x0023] [0x0000] Sn_TX_RD is initialized by OPEN command. However, if Sn_MR(P[3:0]) is TCP mode(‚Äò0001‚Äô), it is re -initialized while connecting with TCP. After its initialization, it is auto -increased by SEND command. SEND command transmits the saved data from the current S n_TX_RD to the Sn_TX_WR in the Socket n TX Buffer. After transmitting the saved data, the SEND command increases the Sn_TX_RD as same as the Sn_TX_WR. If its increment value exceeds the maximum 
 56 / 66 W5500 Datasheet Version1.0. 2 (November 2013) value 0xFFFF, (greater than 0x10000 and the carry bit occurs ), then the carry bit is ignored and will automatically update with the lower 16bits value. Sn_TX_WR ( Socket n TX Write Pointer Register) [R/W] [0x0024 -0x0025] [0x0000] Sn_TX_WR is initialized by OPEN command. However, if Sn_MR(P[3:0]) is TCP mode(‚Äò0001‚Äô), it is re -initialized while connecting with TCP. It should be read or to be updated like as follows. 1. Read the starting address for saving the transmitting data. 2. Save the transmit ting data from the starting address of Socket n TX buffer. 3. After saving the transmitting data, update Sn_TX_WR to the increased value as many as transmitting data size. If the increment value exceeds the maximum value 0xFFFF (greater than 0x10000 and the carry bit occurs ), then the carry bit is ignored and will automatically update with the lower 16bits value. 4. Transmit the saved data in Socket n TX Buffer by using SEND/SEND command Sn_RX_RSR ( Socket n Received Size Register) [R] [0x0026 -0x0027] [0x0000] Sn_RX_RSR indicates the data size received and saved in Socket n RX Buffer. Sn_RX_RSR does not exceed the Sn_RXBUF_SIZE and is calculated as the difference between ‚ÄòSocket n RX Write Pointer (Sn_RX_WR)‚Äô and ‚ÄòSocket n RX Read Pointer (Sn_RX_RD)‚Äô. Ex) In case of 2048(0x0800) in S0_RX_RSR, 0x0026 0x0027 0x08 0x00 Sn_RX_RD ( Socket n RX Read Data Pointer Register) [R/W] [0x0028 -0x0029] [0x0000] Sn_RX_RD is initialized by OPEN command. Make sure to be read or updated as follow s. 1. Read the starting save address of the received data 2. Read data from the starting address of Socket n RX Buffer. 3. After reading the received data, Update Sn_RX_RD to the increased value as many as the reading size. If the increment value exceeds the maximum value 0xFFFF, that is, is greater than 0x10000 and the carry bit occurs, update with the lower 16bits value ignored the carry bit. 4. Order RECV command is for notifying the updated Sn_RX_RD to W5500. 
 W5500 Datasheet Version1.0. 2 (November 2013) 57 / 66 Ex) In case of 2048(0x0800) in S0_RX_RD, 0x0028 0x0029 0x08 0x00 Sn_RX_WR ( Socket n RX Write Pointer Register) [R] [0x002A -0x002B] [0x0000] Sn_RX_WR is initialized by OPEN command and it is auto -increased by the data reception. If the increased value exceeds the maximum value 0xFFFF, (greater than 0x10000 and the carry bit occurs ), then the carry bit is ignored and will automatically update with the lower 16bits value. Ex) In case of 2048(0x0800) in S0_RX_WR, 0x002A 0x002B 0x08 0x00 Sn_IMR ( Socket n Interrupt Mask Register) [R/W] [0x002C ] [0xFF] Sn_IMR masks the interrupt of Socket n. Each bit corresponds to each bit of Sn_IR. When a Socket n Interrupt is occurred and the corresponding bit of Sn_IMR is ‚Äò1‚Äô, the corresponding bit of Sn_IR becomes ‚Äò1‚Äô. When both the corresponding bit of Sn_IMR and Sn_IR are ‚Äò1‚Äô and the n -th bit of IR is ‚Äò1‚Äô, Host is interrupted by asserted INTn PIN to low. 7 6 5 4 3 2 1 0 Reserved Reserved Reserved SEND_OK TIMEOUT RECV DISCON CON Bit Symbol Description 7~5 Reserved Reserved 4 SENDOK Sn_IR(SENDOK) Interrupt Mask 3 TIMEOUT Sn_IR(TIMEOUT) Interrupt Mask 2 RECV Sn_IR(RECV) Interrupt Mask 1 DISCON Sn_IR(DISCON) Interrupt Mask 0 CON Sn_IR(CON) Interrupt Mask 
 58 / 66 W5500 Datasheet Version1.0. 2 (November 2013) Sn_FRAG ( Socket n Fragment Register) [R/W] [0x002D -0x002E] [0x4000 ] Sn_FRAG configures the FRAG(Fragment field in IP header). Ex) Sn_FRAG0 = 0x0000 (Don‚Äôt Fragment) 0x002D 0x002E 0x00 0x00 Sn_KPALVTR (Socket n Keep Alive Time Register) [R/W] [0x002F] [0x00] Sn_KPALVTR configures the transmitting timer of ‚ÄòKEEP ALIVE(KA)‚Äô packet of SOCKETn. It is valid only in TCP mode, and ignored in other modes. The time unit is 5s. KA packet is transmittable after Sn_SR is changed to SOCK_ESTABLISHED and after the data is transmitt ed or receiv ed to/from a peer at least once. In case of 'Sn_KPALVTR > 0', W5500 automatically transmits KA packet after time -period for checking the TCP connection (Auto -keepalive -process). In case of 'Sn_KPALVTR = 0', Auto-keep-alive-process will not operate, and KA packet can be transmitted by SEND_KEEP comman d by the host (Manual -keep-alive-process). Manual -keep-aliveprocess is ignored in case of 'Sn_KPALVTR > 0'. Ex) Sn_KPALVTR = 10 (Keep Alive packet will be transmitted every 50 seconds.) 0x002F 0x0A 
 W5500 Datasheet Version1.0. 2 (November 2013) 59 / 66 Electrical Specifications 5 5.1 Absolute Maximum Ratings Symbol Parameter Rating Unit VDD DC Supply voltage -0.5 to 4.6 V VIN DC input voltage -0.5 to 6 V VOUT DC output voltage -0.5 to 4.6 V IIN DC input current ÔÇ±5 mA TOP Operating temperature -40 to +85 ÔÇ∞C TSTG Storage temperature -65 to +150 ÔÇ∞C *COMMENT: Stressing the device beyond the ‚ÄòAbsolute Maximum Ratings ‚Äô may cause permanent damage. 5.2 Absolute Maximum Ratings ( Electrical Sensitivity) Electrostatic discharge (ESD) Symbol Parameter Test Condition Class Maximum value(1) Unit VESD(HBM) Electrostatic discharge voltage (human body model) TA = +25 ¬∞C conforming to MIL -STD 883F Method 3015.7 2 2000 V VESD(MM) Electrostatic discharge voltage (man machine model) TA = +25 ¬∞C conforming to JEDEC EIA/JESD22 A115-A B 200 V VESD(CDM) Electrostatic discharge voltage (charge device model) TA = +25 ¬∞C conforming to JEDEC JESD22 C101 - C III 500 V Static latchup Symbol Parameter Test Condition Class Maximum value(1) Unit LU Static latch -up class TA = +25 ¬∞C conforming to JESD78A I ‚â• ¬±200 mA 
 60 / 66 W5500 Datasheet Version1.0. 2 (November 2013) 5.3 DC Characteristics (Test Condition: Ta = ‚Äì40 to 85¬∞C) Symbol Parameter Test Condition Min Typ Max Unit VDD Supply voltage Apply VDD, AVDD 2.97 3.3 3.63 V VIH High level input voltage 2.0 5.5 V VIL Low level input voltage - 0.3 0.8 V VT Threshold point All inputs except XI 1.30 1.41 1.53 V VT+ Schmitt trig Low to High Threshold point All inputs except XI 1.53 1.64 1.73 V VTSchmitt trig High to Low Threshold point All inputs except XI 0.95 1.02 1.09 V TJ Junction temperature 0 25 125 ¬∞C IL Input Leakage Current ÔÇ±1 ÔÅ≠A RPU Pull-up Resistor SCSn, RSTn, PMODE[2:0] 62 77 112 Kohm RPD Pull-down Resistor RSVD (Pin 23, Pin 38 ~ Pin 42) 48 85 174 Kohm VOL Low level output voltage IOL = 8mA, All outputs except XO 0.4 V VOH High level output voltage IOH = 8mA, All outputs except XO 2.4 V IOL Low level output Current VOL = 0.4V, All outputs except XO 8.6 13.9 18.9 mA IOH High level output Current VOH = 2.4V, All outputs except XO 12.5 26.9 47.1 mA IDD1 Supply Current (Normal operation mode) VDD=3.3V, AVDD=3.3V, Ta = 25¬∞C 132 mA IDD2 Supply Current (Power Down mode) PHY Power Down mode, VDD=3.3V, AVDD=3.3V, Ta = 25¬∞C 13 mA 
 W5500 Datasheet Version1.0. 2 (November 2013) 61 / 66 5.4 Power Dissipation (Test Condition: VDD=3.3V, AVDD=3.3V, Ta = 25¬∞C) Condition Min Typ Max Unit 100M Link - 128 - mA 10M Link - 75 - mA Un-Link (Auto -negotiation mode) - 65 - mA 100M Transmitting - 132 - mA 10M Transmitting - 79 - mA Power Down mode - 13 - mA 5.5 AC Characteristics 5.5.1 Reset Timing Figure 22. Reset Timing Symbol Description Min Max TRC Reset Cycle Time 500 us - TPL RSTn to internal PLOCK (PLL Lock) - 1 ms 5.5.2 Wake up Time Voltage Regulator Wake up Time: 10us 5.5.3 Crystal Characteristics Parameter Range Frequency 25 MHz Frequency Tolerance (at 25 ‚ÑÉ) ¬±30 ppm Shunt Capacitance 7pF Max Drive Level 59.12uW/MHz Load Capacitance 18pF Aging (at 25 ‚ÑÉ) ¬±3ppm / year Max RSTn TPLTRC PLOCK (Internal)
 62 / 66 W5500 Datasheet Version1.0. 2 (November 2013) 5.5.4 SPI Timing Figure 23. SPI Timing 4 Theoretical Guaranteed Speed Even though theoretical design speed is 80MHz, the signal in the high speed may be distorted because of the circuit crosstalk and the length of the signal line. The minimum guaranteed speed of the SCLK is 33.3 MHz which was tested and measured with the sta ble waveform. Please refer to the SPI Application Note which shows the WIZnet test environment and results. 5 2.1ns is when pn loaded with 30pF. The time is shorter with lower capacitance. SCSn SCLK MOSI MISOTWH TWL HI-Z HI-ZVIH VIL VIH VIL VIH VIL VOH VOLTDSTDH TOH TCHZ TOVTCSSTCS TCSHSymbol Description Min Max Units FSCK SCK Clock Frequency 80/33.34 MHz TWH SCK High Time 6 ns TWL SCK Low Time 6 ns TCS SCSn High Time 30 ns TCSS SCSn Setup Time 5 - ns TCSH SCSn Hold Time 5 ns TDS Data In Setup Time 3 ns TDH Data In Hold Time 3 ns TOV Output Valid Time 5 ns TOH Output Hold Time 0 ns TCHZ SCSn High to Output Hi -Z 2.15 ns 
 W5500 Datasheet Version1.0. 2 (November 2013) 63 / 66 5.5.5 Transformer Characteristics Parameter Transmit End Receive End Turn Ratio 1:1 1:1 Inductance 350 uH 350 uH Figure 24. Transformer Type 5.5.6 MDIX W5500 does not support auto -MDIX feature. Thus, user should use straight -through cables to connect to other switches or routers and crossover cables to connect to devices such as servers, workstations or another W5500. However, user can use either type of cable to connect to other devices with auto -MDIX enabled, and the interface automatically corrects for any incorrect cabling. 
 64 / 66 W5500 Datasheet Version1.0. 2 (November 2013) Package Description s 6 Figure 25. Package Dimensions Note 1. These dimensions do not include mold protrusion. 2. ( ) is reference. 3. [ ] is ass ‚Äôy out quality. 4. UNIT: mm 
 W5500 Datasheet Version1.0. 2 (November 2013) 65 / 66 Document History Information Version Date Descriptions Ver. 1.0 .0 1AUG 2013 Initial Release Ver. 1.0 .1 13SEP 2013 Corrected duplicated statements and typing errors (P .14, 23, 24, 28, 39, 51) Corrected descriptions (P .35) Ver. 1.0 .2 14NOV 2013 1. Changed ‚Äúdescriptions of pin at 1.1 Pin Descriptions ‚Äù(P.10) from It must be tied to GND to NC(PIN38~42) 2. Corrected typing error: from 0x02 to 0x42 value of SOCK_MACRAW at 4.2 Socket Registers (P.50) 
 66 / 66 W5500 Datasheet Version1.0. 2 (November 2013) Copyright Notice Copyright 201 3 WIZnet Co., Ltd. All Rights Reserved. Technical Support: support@wiznet.co.kr Sales & Distribution: sales@wiznet.co.kr For more information, visit our website at http://www.wiznet.co.kr