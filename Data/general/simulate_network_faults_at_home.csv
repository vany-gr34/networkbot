mot_cl√©,post_et_reponses
simulate network faults at home,"this is years of mismanagement that needs fixed. i have cisco switches deployed all over with vlans in their database that are no longer active. i remove them, they come back. i cannot find a single cisco switch in my network with the vtp domain configured. i believe that this was configured on a switch years ago that has since been retired. am i understanding this behavior correctly? all cisco switches have vtp server enabled by default. so, therefore any switch that has been connected over the years is now configured for that vtp domain, therefore propagating this vtp configuration from switch to switch? to make matters worse. switches that have been deployed to other locations have the same behavior because someone connected them at our home office to drop the initial config on them before they were shipped. therefore, yet again adding these same vlans to switches that dont need them. also, is there a better way to deal with this besides changing vtp mode to off or transparent on every switch then cleaning up the vlan dbs? || also, is there a better way to deal with this besides changing vtp mode to off or transparent on every switch then cleaning up the vlan dbs? nope. just turn it off or set it to transparent mode. if it makes sense, perhaps migrate to version 3 and set a single switch as the server core and the rest to client. || i personally have been bitten by vtp version 2. use version 3 or nothing. || the default mode is server mode but the switches will not send any update until a vtp domain is configured. so no switch will participate in vtp unless the domain is configured as well. i find it strange that the vlans are added back randomly, are you really sure that you have checked every single switch with no vtp configured? when you remove a vlan, it should in fact delete the vlan on all switches in the same vtp domain, not add it back. also, as being mentioned, just get rid of vtp, regardless of which version you go for. it really can cause headaches and has caused headaches over the years. instead, if you want to effectively propagate vlans and such, use automation for that, such as ansible, python script etc."
simulate network faults at home,"update 41525 the flapping continued but at least i knew it wasnt occurring between the vpc link i had a limited number of sfp modules to work with so i couldnt change them all however with this information i went and dug into the possibility of lacp causing the flap and i believe i discovered the event that triggers the link flap in the ethpm event history show system internal ethpm eventhistory interface ethernet 147 45 fsmethernet147 transition at 19202 usecs after sun apr 13 000944 2025 previous state triggered event next state when i checked lacp counters that link had a difference of over 10000 pdus sentrcv and when checking the interfaces themselves on catalyst1 found an enormous number of input errors logged on both members of the channelgroup. as to why these are becoming out of sync is still tbd, open to ideas update 41125 swapped out sfp and fiber cabling between nexus switches, will update on monday if anything changes. i am at my wits end trying to figure out this issue that is happening between some catalystnexus switches. roughly every 48 hours 10 minutes one of the members of a 2 interface portchannel connecting a pair of nexuscatalyst switches will flap and come back up without any error or fault being logged. this causes the entire network to go down briefly stp topo change? while the port is changing states. after the port comes back up, everything behaves normally until the next mostly predictable flaps happens. now this is where it is confusing me, the original network configuration was a series of switches connected in a ring, with two ports running lacp linking each of the switches together, so something like this nx1nx2cat1cat2cat3cat4nx1 however, i disabled the link from cat4 back to nx1 while testing as this link was the one that was initially flapping, but since those ports were disabled the link between nexus2cat1 has started the exact same behavior. logging has been unhelpful and only shows the ports going down without any insight into the cause of this, has anyone experienced anything like this or have a direction to investigate further? ive checked everything i could think of, stp, lacp, portchannel config, and nothing appears abnormal or is getting recorded. excerpts of what logs look like between the devices nexus2 2025 apr 6 000539 nexussw2 ethportchannel5fopchanged portchannel20 first operational port changed from ethernet148 to ethernet147 2025 apr 6 000539 nexussw2 ethportchannel5portdown portchannel20 ethernet148 is down 2025 apr 6 000539 nexussw2 ethport5iftrunkdown interface ethernet148, vlan 1,10,16,20,30,40,50,100,200,50 0,555,600,840842 down 2025 apr 6 000539 nexussw2 ethport3ifdowninitializing interface ethernet148 is down initializing 2025 apr 6 000539 nexussw2 lldp5serverremoved server with chassis id 5cb1.2efd.7669 port id gi112 on loca l port eth148 has been removed 2025 apr 6 000539 nexussw2 last message repeated 1 time 2025 apr 6 000539 nexussw2 cdp5neighborremoved cdp neighbor catasw1 on port ethernet148 has been removed 2025 apr 6 000542 nexussw2 ethportchannel5portup portchannel20 ethernet148 is up 2025 apr 6 000542 nexussw2 ethport5iftrunkup interface ethernet148, vlan 1,10,16,20,30,40,50,100,200,500, 555,600,840842 up 2025 apr 6 000542 nexussw2 ethport3ifup interface ethernet148 is up in mode trunk 2025 apr 6 000543 nexussw2 cdp5neighboradded device catasw1 discovered of type cisco c9200l48p4g with port gigabitethernet112 on incoming port ethernet148 with ip addr 10.149.4.96 and mgmt ip 10.149.4.96 2025 apr 6 000545 nexussw2 lldp5serveradded server with chassis id 5cb1.2efd.7669 port id gi112 managemen t address 10.149.4.96 discovered on local port eth148 in vlan 0 with enabled capability bridge router 2025 apr 6 000606 nexussw2 ethportchannel5fopchanged portchannel20 first operational port changed from ethernet147 to ethernet148 2025 apr 6 000606 nexussw2 ethportchannel5portdown portchannel20 ethernet147 is down 2025 apr 6 000606 nexussw2 ethport5iftrunkdown interface ethernet147, vlan 1,10,16,20,30,40,50,100,200,50 0,555,600,840842 down 2025 apr 6 000606 nexussw2 ethport3ifdowninitializing interface ethernet147 is down initializing 2025 apr 6 000606 nexussw2 cdp5neighborremoved cdp neighbor catasw1 on port ethernet147 has been removed 2025 apr 6 000606 nexussw2 lldp5serverremoved server with chassis id 5cb1.2efd.7669 port id gi111 on loca l port eth147 has been removed 2025 apr 6 000610 nexussw2 last message repeated 1 time 2025 apr 6 000610 nexussw2 ethportchannel5portup portchannel20 ethernet147 is up 2025 apr 6 000610 nexussw2 ethport5iftrunkup interface ethernet147, vlan 1,10,16,20,30,40,50,100,200,500, 555,600,840842 up 2025 apr 6 000610 nexussw2 ethport3ifup interface ethernet147 is up in mode trunk 2025 apr 6 000610 nexussw2 cdp5neighboradded device catasw1 discovered of type cisco c9200l48p4g with port gigabitethernet111 on incoming port ethernet147 with ip addr 10.149.4.96 and mgmt ip 10.149.4.96 2025 apr 6 000612 nexussw2 lldp5serveradded server with chassis id 5cb1.2efd.7669 port id gi111 managemen t address 10.149.4.96 discovered on local port eth147 in vlan 0 with enabled capability bridge router 2025 apr 6 040404 nexussw2 ethportchannel5portdown portchannel20 ethernet147 is down 2025 apr 6 040404 nexussw2 ethport5iftrunkdown interface ethernet147, vlan 1,10,16,20,30,40,50,100,200,50 0,555,600,840842 down 2025 apr 6 040404 nexussw2 ethport3ifdowninitializing interface ethernet147 is down initializing 2025 apr 6 040404 nexussw2 cdp5neighborremoved cdp neighbor catasw1 on port ethernet147 has been removed 2025 apr 6 040404 nexussw2 lldp5serverremoved server with chassis id 5cb1.2efd.7669 port id gi111 on loca l port eth147 has been removed 2025 apr 6 040408 nexussw2 last message repeated 1 time 2025 apr 6 040408 nexussw2 ethportchannel5portup portchannel20 ethernet147 is up 2025 apr 6 040408 nexussw2 ethport5iftrunkup interface ethernet147, vlan 1,10,16,20,30,40,50,100,200,500, 555,600,840842 up 2025 apr 6 040408 nexussw2 ethport3ifup interface ethernet147 is up in mode trunk 2025 apr 6 040408 nexussw2 cdp5neighboradded device catasw1 discovered of type cisco c9200l48p4g with port gigabitethernet111 on incoming port ethernet147 with ip addr 10.149.4.96 and mgmt ip 10.149.4.96 2025 apr 6 040410 nexussw2 lldp5serveradded server with chassis id 5cb1.2efd.7669 port id gi111 managemen t address 10.149.4.96 discovered on local port eth147 in vlan 0 with enabled capability bridge router 2025 apr 6 041112 nexussw2 ethportchannel5portdown portchannel20 ethernet147 is down 2025 apr 6 041112 nexussw2 ethport5iftrunkdown interface ethernet147, vlan 1,10,16,20,30,40,50,100,200,50 0,555,600,840842 down 2025 apr 6 041112 nexussw2 ethport3ifdowninitializing interface ethernet147 is down initializing 2025 apr 6 041112 nexussw2 lldp5serverremoved server with chassis id 5cb1.2efd.7669 port id gi111 on loca l port eth147 has been removed 2025 apr 6 041112 nexussw2 last message repeated 1 time 2025 apr 6 041112 nexussw2 cdp5neighborremoved cdp neighbor catasw1 on port ethernet147 has been removed 2025 apr 6 041115 nexussw2 ethportchannel5portup portchannel20 ethernet147 is up 2025 apr 6 041115 nexussw2 ethport5iftrunkup interface ethernet147, vlan 1,10,16,20,30,40,50,100,200,500, 555,600,840842 up 2025 apr 6 041115 nexussw2 ethport3ifup interface ethernet147 is up in mode trunk 2025 apr 6 041116 nexussw2 cdp5neighboradded device catasw1 discovered of type cisco c9200l48p4g with port gigabitethernet111 on incoming port ethernet147 with ip addr 10.149.4.96 and mgmt ip 10.149.4.96 2025 apr 6 041118 nexussw2 lldp5serveradded server with chassis id 5cb1.2efd.7669 port id gi111 managemen t address 10.149.4.96 discovered on local port eth147 in vlan 0 with enabled capability bridge router 2025 apr 6 041138 nexussw2 ethportchannel5portdown portchannel20 ethernet147 is down 2025 apr 6 041138 nexussw2 ethport5iftrunkdown interface ethernet147, vlan 1,10,16,20,30,40,50,100,200,50 0,555,600,840842 down 2025 apr 6 041138 nexussw2 ethport3ifdowninitializing interface ethernet147 is down initializing 2025 apr 6 041138 nexussw2 lldp5serverremoved server with chassis id 5cb1.2efd.7669 port id gi111 on loca l port eth147 has been removed 2025 apr 6 041138 nexussw2 cdp5neighborremoved cdp neighbor catasw1 on port ethernet147 has been removed 2025 apr 6 041138 nexussw2 lldp5serverremoved server with chassis id 5cb1.2efd.7669 port id gi111 on loca l port eth147 has been removed 2025 apr 6 041141 nexussw2 ethportchannel5portup portchannel20 ethernet147 is up 2025 apr 6 041141 nexussw2 ethport5iftrunkup interface ethernet147, vlan 1,10,16,20,30,40,50,100,200,500, 555,600,840842 up 2025 apr 6 041141 nexussw2 ethport3ifup interface ethernet147 is up in mode trunk 2025 apr 6 041142 nexussw2 cdp5neighboradded device catasw1 discovered of type cisco c9200l48p4g with port gigabitethernet111 on incoming port ethernet147 with ip addr 10.149.4.96 and mgmt ip 10.149.4.96 2025 apr 6 041144 nexussw2 lldp5serveradded server with chassis id 5cb1.2efd.7669 port id gi111 managemen t address 10.149.4.96 discovered on local port eth147 in vlan 0 with enabled capability bridge router 2025 apr 6 080621 nexussw2 ethportchannel5portdown portchannel20 ethernet147 is down 2025 apr 6 080621 nexussw2 ethport5iftrunkdown interface ethernet147, vlan 1,10,16,20,30,40,50,100,200,50 0,555,600,840842 down 2025 apr 6 080621 nexussw2 ethport3ifdowninitializing interface ethernet147 is down initializing 2025 apr 6 080621 nexussw2 lldp5serverremoved server with chassis id 5cb1.2efd.7669 port id gi111 on loca l port eth147 has been removed 2025 apr 6 080621 nexussw2 last message repeated 1 time 2025 apr 6 080621 nexussw2 cdp5neighborremoved cdp neighbor catasw1 on port ethernet147 has been removed 2025 apr 6 080625 nexussw2 ethportchannel5portup portchannel20 ethernet147 is up 2025 apr 6 080625 nexussw2 ethport5iftrunkup interface ethernet147, vlan 1,10,16,20,30,40,50,100,200,500, 555,600,840842 up 2025 apr 6 080625 nexussw2 ethport3ifup interface ethernet147 is up in mode trunk 2025 apr 6 080625 nexussw2 cdp5neighboradded device catasw1 discovered of type cisco c9200l48p4g with port gigabitethernet111 on incoming port ethernet147 with ip addr 10.149.4.96 and mgmt ip 10.149.4.96 2025 apr 6 080627 nexussw2 lldp5serveradded server with chassis id 5cb1.2efd.7669 port id gi111 managemen t address 10.149.4.96 discovered on local port eth147 in vlan 0 with enabled capability bridge router 2025 apr 6 080707 nexussw2 ethportchannel5fopchanged portchannel20 first operational port changed from ethernet148 to ethernet147 2025 apr 6 080707 nexussw2 ethportchannel5portdown portchannel20 ethernet148 is down 2025 apr 6 080707 nexussw2 ethport5iftrunkdown interface ethernet148, vlan 1,10,16,20,30,40,50,100,200,50 0,555,600,840842 down 2025 apr 6 080707 nexussw2 ethport3ifdowninitializing interface ethernet148 is down initializing 2025 apr 6 080707 nexussw2 lldp5serverremoved server with chassis id 5cb1.2efd.7669 port id gi112 on loca l port eth148 has been removed 2025 apr 6 080707 nexussw2 last message repeated 1 time 2025 apr 6 080707 nexussw2 cdp5neighborremoved cdp neighbor catasw1 on port ethernet148 has been removed 2025 apr 6 080710 nexussw2 ethportchannel5portup portchannel20 ethernet148 is up 2025 apr 6 080710 nexussw2 ethport5iftrunkup interface ethernet148, vlan 1,10,16,20,30,40,50,100,200,500, 555,600,840842 up 2025 apr 6 080710 nexussw2 ethport3ifup interface ethernet148 is up in mode trunk 2025 apr 6 080711 cdp5neighboradded device catasw1 discovered of type cisco c9200l48p4g with port gigabitethernet112 on incoming port ethernet148 with ip addr and mgmt ip 2025 apr 6 080713 lldp5serveradded server with chassis id port id gi112 managemen t address 10.149.4.96 discovered on local port eth148 in vlan 0 with enabled capability bridge router catalyst 1 001934 apr 6 000538.608 pdt lineproto5updown line protocol on interface gigabitethernet112, changed state to down 001935 apr 6 000543.247 pdt lineproto5updown line protocol on interface gigabitethernet112, changed state to up 001936 apr 6 000605.684 pdt lineproto5updown line protocol on interface gigabitethernet111, changed state to down 001937 apr 6 000610.326 pdt lineproto5updown line protocol on interface gigabitethernet111, changed state to up 001938 apr 6 040403.927 pdt lineproto5updown line protocol on interface gigabitethernet111, changed state to down 001939 apr 6 040408.583 pdt lineproto5updown line protocol on interface gigabitethernet111, changed state to up 001940 apr 6 041111.636 pdt lineproto5updown line protocol on interface gigabitethernet111, changed state to down 001941 apr 6 041116.307 pdt lineproto5updown line protocol on interface gigabitethernet111, changed state to up 001942 apr 6 041137.392 pdt lineproto5updown line protocol on interface gigabitethernet111, changed state to down 001943 apr 6 041142.140 pdt lineproto5updown line protocol on interface gigabitethernet111, changed state to up 001944 apr 6 080620.927 pdt lineproto5updown line protocol on interface gigabitethernet111, changed state to down 001945 apr 6 080625.467 pdt lineproto5updown line protocol on interface gigabitethernet111, changed state to up 001946 apr 6 080706.978 pdt lineproto5updown line protocol on interface gigabitethernet112, changed state to down 001947 apr 6 080711.603 pdt lineproto5updown line protocol on interface gigabitethernet112, changed state to up || yes alteady seen some flapping between devices. it was all the time a layer1 issue. replace the sfp, change the fiber, clean the fiber plug. nobody takes care but if you have dust on the fiber plug, it can easily perturbate the signal. in addition, what are the nexus devices? n5k or n9k? if n9k, try these commands show pie interface ethernetxx transceiverinsights show pie interface ethernetxx linkflaprca show pie interface ethernetxx linkdownrca and check the transceiver detail txrx || when this suddenly started happening on one of our nexus links when we went to the rack we found a sm cable instead of a mm for that link, the tech said it worked before without issue, we then had to review all their work and explain it has to match the sfp type || looks like you forced the root bridge to be nexus 1 so should eliminate spanning tree problem. i would double check layer 2 layer 3 vpc consistency on the nexus switches as well. since its the link between the nexus and catalyst that is always being shutdown i bet it is some sort of vpc consistency parameter that is failing or one of the issues below that would bring down a vpc. thats a weird topology to me. i normally only see that type of ring topology in a large warehouse. are all those switches in the close together in the same room or at least campus are? normally i would see nexus 1 and nexus 2 with vpc link between the two, then all the catalyst switches would have a two links in a single port channel to each nexus 1 and nexus 2 switch. i would honestly just open up a ticket with cisco tac if cant fix do a google search on cisco nexus troubleshooting vpcs can run below commands in cisco nexus switch. show vpc consistencyparameters show vpc consistencyparameters interface po 10 change to match each portchannel you use vpcs in blocking state vpcs might be in the blocking state because of bridge assurance ba. vlans on a vpc moved to suspend state vlans on a vpc might move to the suspend state. symptom possible cause solution vlans on a vpc are moved to the suspend state. vlans allowed on the vpc have not been allowed on the vpc peer link. all vlans allowed on a vpc must also be allowed on the vpc peer link. also, we recommend that only vpc vlans are allowed on the vpc peer link."
simulate network faults at home,"hi all, i run a small business providing it, network, and security system support. a large part of my business is taking over sites that have been neglected. often i will come across cable issues with cat6, and rs485. i am wonderimg the best way to test these cables. i am not certifying cables, just testing them to inform the client of the fault. for cable issues i would then arrange for a cable to be replaced by a contractor on the customers behalf, then test the cable again. i am hoping someone can give me advice on the best way to test a faulty cable. i think the first test might be iperf just to check the max speed of a connection. there is a fairly cheap router appliance on amazon that has 2.5gb copper nics and sfp ports for 10gb connections. one of those on either end and i should be able to get max throughput. but is that enough to identify a fault? would i be better off with an oscilloscope, and if so, which? i was looking at the owon 200 handheld series. this might also be good for testing rs485 faults? do i need both? or is there a better not too costly alternative? i dont have the budget for a fluke unfortunately. and even if i did, doesnt test rs485. iperf checking speed of both fibre and copper seems like the best value, but not sure if iperf will give me enough data, such as packet loss. i also want to be able to export logs to a spreadsheet. any advice greatly appreciated. || iperf is not going to help you identify faults anymore than a cheap continuity tester would. youre charging clients money to do a job, so do it right. either cough up the cash for a qualification tester, or bring in a subcontractor with one. a basic fluke cableiq is a bit over 2,000. || if youre subcontracting out the repair of structured cabling to a contractor, theyre going to have their own qualificationcertification equipment that can produce reports to the customer. you can get a used netally or fluke if money is short, but ideally youd want something that can export reports with linklive netally or linkware fluke. || you need something that will check the cabling ensure its wired correctly and can perform tdr and otdr functionality. that will tell you how long is this cable. how far from here is it cut or shorted. the netally units are pretty reasonably priced for these tasks and they can email you a report for each live drop you test. i wouldnt use anything less capable than one of these for this function. will also identify connected equipment, what switch and switch port you are plugged into, will negotiate poe, can also authenticate 802.1x can ping predefined hosts, check the wire map, all at the single press of a button, then automatically email that report i mentioned. i bought one for the office. it gets used rarely, but when its needed it saves a lot of time."
simulate network faults at home,"hey everyone, with two of my friends, we wanted to set up a shared subnet across our three homelabs, each in a different physical location. to do this, we used our existing infrastructure with proxmox and opnsense. i followed the vxlan bridge guide from the official opnsense documentation for the underlay, i decided to go with wireguard which ive been using for years and set up the vteps just like in the tutorial. at first, for a proof of concept, i just wanted to route the network between our three sites using vni 15. between two sites, everything worked perfectly. i set the mtu of my wireguard interfaces to 1600, as recommended in the opnsense forums, so that my bridges and vxlan interfaces could stay at 1500 mtu. that way, i didnt have to deal with custom mtus or tcp mss normalization issues. i also tested with dont fragment df flag across the internet, and mtu 1600 worked fine without fragmentation between the vtep interfaces of each site through the wireguard tunnel. but when i tried adding the third site, things got complicated. initially, i set up one wireguard interface per site with two peers one for each of the other two sites. then, on each firewall, i created two vxlan interfaces site 1 vxlan1 for vtepsite1 to vtepsite2 vxlan2 for vtepsite1 to vtepsite3 site 2 vxlan1 for vtepsite2 to vtepsite1 vxlan2 for vtepsite2 to vtepsite3 site 3 vxlan1 for vtepsite3 to vtepsite1 vxlan2 for vtepsite3 to vtepsite2 but then i hit a limitation in unicast mode as described in the opnsense guide, i cant use the same vni 15 on two vxlan interfaces. i get this error network identifier x already exists in this socket this caused some really weird behavior fw1 can communicate with fw2 and fw3 fw2 and fw3 cant communicate with each other over vxlan to fix this, i had to do something a bit weird with network bridges by assigning different vni ids per pair of sites fw1 to fw2 vni 15 fw1 to fw3 vni 16 fw2 to fw3 vni 17 i know this is not a standard vxlan setup at all, but its the only solution i found for now ive never done vxlan before . so, on each firewall, i now have a network bridge bridge0 that links the two vxlan interfaces and the physical nic fw1 bridge0 fw2 bridge0 fw3 bridge0 right now, this works, but im starting to realize its not maintainable at all. if i want to transport other networks like 10.8.16.024, 10.8.17.024, 10.8.18.024, id have to either create at least 3 new interfaces on each opnsense firewall 2 vxlan interfaces 1 nicvlan and another bridge. or create vlans on bridge0, but as far as i know, opnsense doesnt support vlans on a bridge interface. or use vxlans native vlan transport, but i dont really know how to do that on opnsense. i looked into multicast vxlan, which seems like the perfect solution for my use case, but wireguard doesnt support multicast, so thats not an option. id really like to avoid using ipsec if possible. so now im trying to figure out the best way to design this network so that its functional reliable fault tolerant and easy to monitor maintainable without adding too much complexity if i want to add a new subnet and ideally performant we have great fiber network it should be great to use it if anyone has experience with vxlan on opnsense or a similar setup, id love to hear your thoughts! im open to discussions about every part of my setup. thanks for your help! || functional reliable fault tolerant and easy to monitor maintainable without adding too much complexity if i want to add a new subnet and ideally performant we have great fiber network it should be great to use it honestly? abandon layer 2 and go for layer 3. then run bgp with your friends and you can exchange routes. everything is better at layer 3. if you are crazy enough to do layer 2, ideally your opnsense should not have any vxlan configuration on it. usually only the endpoints of a vxlan network here proxmox are aware of the layer 2 vxlan aspect, and all the nodes in the middle here opnsense and wireguard only see a plain layer 3 udp packet. || this boils down to how do you extend l2 between sites which is a question that engineers have been trying to answer for 20 years. the right answer is dont. the fun answer is vxlan like you want to do. the easy and expensive answer is metroe. the cluster fuck answer is routing individual hosts between sites and have a hub site. the hacky answer is mpls over gres. but seriously, if you arent familiar with vxlan, let alone a dynamic protocol for an underlay just avoid it and do layer 3. it saves a lot of heartache especially if you dont get any benefit from extending l2. || im a big vxlan guy. probably setup a dozen very large ip fabrics in my time. but it works best as a lan tool, low latency, with many paths supported by a layer 3 underlay. for your use case you are over complicating what you need. just go l3. vxlan isnt meant to bridge a broadcast domain over the wan."
simulate network faults at home,"i might be looking for a unicorn device but im hoping someone might have an idea of the options out there. usecase were an isp and have a lot of business customers with two uplinks to our pe devices but a single ip homed on these devices that acts as their default gateway. these pe devices are currently cisco 3750s or 3850s in a stackvss configuration so they are logically 1 device. we are looking at replacing these devices, but dont know what our best option would be. this is very important the stackvss gives us high availability protection if one of devices in the stack dies while not requiring us to use 3 ips from our customers network range. afaik requiring 3 ips is the biggest drawback for protocols like vrrp and why a pair of devices working in an mlag will not meet our requirements. requirements stackable able to share an ip so if one device dies, the others in the stack will still respondpass traffic with the same ip. this could also be a single device but with dualsupervisors, just something that will provide us with physical redundancy. linkagglacp interface 1 on stackmembera and interface 2 on stackmemberb should be able to be put into a portchannel together going down to the customer so that the customer device has 2 uplinks but sees our devices as 1 logical device. ospf the device ideally needs to be able to speak ospf so it can get routes from our upstream router and know where to send customer traffic. if it cant do ospf, then at least it needs to be able to do ip sla so we can setup static routes and monitor them, but ospf would be easier 10g ports we have a mix of 1g and 10g customers, mostly 1g. the device needs to have at least 10g capable uplinks and ideally 10g capable interfaces for customer access sfp the easiest thing would be for the device to use sfps so we can mix and match the module depending on if the customer has a fiber or copper handoff low portdensity we typically dont need 48 ports. something with 12 or even 6 ports would be fine. we deploy these devices at the customers location and only occasionally have more than one customer running over a given pair of devices 2keuros a device this one might be tricky, but were not against buying used. so yeah, that might be a unicorn but we need something that has physical redundancy and that can share an ip across that physical redundancy. we already have a lot of customers on our existing gear with 30s and so going the mlag vrrp route is not an option for us. unless there is some hardwarefeature set with mlag that provides the same shared ip functionality as vss || if you implement evpn in your fibre aggregation layer, you can take lags from your customer switches directly and then terminate a single 31 gateway on two pes for protection. same ip, two devices. totally valid in evpn. as evpn relies on bgp there is no vendor stack technology to fail in this design, making it superior to a stack. while your fibre aggregation might not support this now, the savings on edge devices may justify this approach. || unpopular opinion, stop doing that. almost every isp only offers a single handoff from a single device. the cpe isnt the weak point, typically. || extreme networks can do this with a 5420. in an mclag cluster, they have a proprietary alternative to vrrp that only needs 1 ip address."
simulate network faults at home,"were running bgp with dualhomed isps to cogent and att. ive checked all the usbased servers listed on but all of them are routing out cogent. im trying find a public iperf server thats hosted on an att provided network. thanks || dumb thought, but can you add a temporary route to punt the 24 that one of the iperf public servers is on out the att link instead?"
simulate network faults at home,"for all my career ive been an enterprise network engineer, but ive always wanted to be able to peek behind the iron curtain and understand just how the isps of the public internet are designed. i know ill never work for any of the isps im working in vendorland now... but i dont want to give up on my nerdy dream of being able to model the public internet within my own home lab. what ive been thinking of is this 4x tier 1 isps representing att, verizon, orange, and bt, with their ass peered in a full mesh. several regionallocal isps, buying transit from 2 of the t1s, which will provide broadband service to home users. smbs, and branch offices. a big enterprise customer environment 2 dcs, 5 branches smaller customer environments. 11x pops in the us, representing seattle, sf, phoenix, minneapolis, denver, dallas, chicago, stl, new york, dc, atlanta. if i have room to scale up, i might add something to simulate europe as well. im guessing probably 150 iou nodes total but ive got a beefy pc that can handle it 32 cpu threads, 64gb of ram my questions for you guys are is this scale sufficient to represent the north american internet? how should each pop be connected to each other? partial mesh based on geography? or would a hub spoke topology with core pops be a better reprsentative? how many pops should the tier 1s be peering with each other at? all of them, or just a subset? how many transit providers should the smaller isps have? is two sufficient? do isps generally take a hotpotato or coldpotato approach when it comes to interas traffic forwarding? i.e. get this packet out of my as as fast as possible or keep this packet on my as for as long as possible? || be careful getting in to tier 1 tier 2 designations. there are networks who buy transit from other networks and those who dont. throw a cdn or two in there. have it connected to the tier 1s and see how it is distributed, then have them connected to the smaller regional networks as well. change dc to ashburn. tier 1s will peer with each other in every location they have in common. smaller isps should have at least 2 transit providers, but you will find some just have multiple connections to the same isp but connecting to different cores. really small isps may just have a single link to a single provider. every core should connect to at least 2 other cores, but i would recommend at least 3. double failures do occur. || dn42 || ebgp by default is hot potato. the reason for it is is that the other asn is somewhat opaque to you. you are always sure youve done the right thing by egressing the traffic asap. you may or may not have done the right thing if you carry it further on your network and give it to the other isp at another interconnect. look up med and how they work between asns to signal ingress preference meds sent on a large network should roughly follow igp costs."
simulate network faults at home,"this is a soho with multiple devices on a 10g eth backbone, so i hope it doesnt qualify as home networking, although many devices are consumeradjacent, like the ones i am having issues with i am posing on cisco, but it looks like its an issue that can maybe be solved by setting some dhcp option of some sort, or at least having a different perspective on the issue itself. hello, i never resorted to asking for help on networking, much less on cisco, where everything is usually working, and if its not, its usually your fault... but... i have a router assigning dhcp on a simple 24 network. i have two different wifi providers i can use one is the router itself which can act as an access point, the other provider is multiple cisco 150ax devices. this behavior happens seldomly when roaming between 150axs, but it happens every time a client roams or even just maually changes ap from the builtin router wlan to the cisco 150ax published one. i used this failure reliability to narrow down the issue. what is the issue? the client cannot get a dhcp response when switching to a 150ax ap. i tried logs at all different levels, i also tried android debugging the wifi stack, but it always comes down to the ap doing some sort of fun stuff behind the scenes, and i also saw a log which i dont have a screenshot of, dumb me, and cant recall how to reproduce of the 150ax thinking that the mac address authenticating to it, is askingobtainingrequesting an ip address that is impossible to be real, because the client is connected elsewhere, and thus has to be forged. this results in the client not receiving a dhcp response on the air, and deauthenticating after a few seconds, due to timeout. the client works fine if reconnecting to the router ap, and works fine if, after some time looks like 5 minutes of no connectivity has not to connect to the router ap tries to connect back to the cisco 150ax published network. looks a lot like some sort of security lockout. what i have tried different dhcp servers different client devices oss even happens with some google home unit and also woth the damn washing machine different network authentication methods including open different wlan asides different 150ax units firmware upgradedowngrade adding the device mac address to the local users 2.4g or 5g, in different bands, with different channel widths all roaming related options onoffmixed rf optimizationsdetections onoffmixed dhcphttp profiling onoff if a client is known on the network, it wont allow it to connect to the ciscopublished wireless network. i also have found no option to disable any kind of dhcp snooping andor inspection, which would solve my problem, since its a soho setup, and i dont need the added security. when it works, its flawless, with 1200mbps peak speeds, and all the bells and whistles. when it doesnt, its 5 minutes lockout, and i am keeping a backup ssid on the router active, so that i can connect... but how can a 50 shitty provider wireless router have less problem than a socalled business device? ahhhh i miss linksys 54gs thanks in advance to whomever could help with this. its driving me mad, and thinking of throwing away hundreds of dollars of hardware its several 150axs and switching to something dumber. || "
simulate network faults at home,"at my company, i cannot access our routers to restart them and control them via our unifi network server 8.6.9. we have the unifi network server program, but when we attempt to access it via login, it does not accept the credentials im not sure if they are correct it has been multiple years since we needed to get back in it, and it wont send us a reset password as the email doesnt make it to inbox though we know the email we are trying to reset is correct so it doesnt seem to recognizing us as a user. unifi said the only recourse is to recreate our entire wifi network from scratch not an ideal proposition. unifi was previously the ubiquiti brand, and i am afraid that after they were merged, our account was lost in the ether as it wasnt migrated potentially our fault for not migrating it. my supervisor was managing this account before i onboarded a few years back. does anyone know any information on this topic? ideally, we would just update our credentials and log in to the existing system, but i am not sure this is an option. unifi has offered chat support but no phone support. thank you in advance for any pointers or advice. || unifi was previously the ubiquiti brand, and i am afraid that after they were merged, our account was lost in the ether as it wasnt migrated potentially our fault for not migrating it. my supervisor was managing this account before i onboarded a few years back. not sure what you mean here, unifi is still a ubiquiti brand and theres no merger im aware of. you cant log into the controller, but can you log in to the server its hosted on? or is it not self hosted? || i has a similar issue when i first setup my first controller, turns out i used a capital letter in the user name, yes the user name is case sensitive, check the original doco and replicate the case of both username and password. otherwise do the rest via the database"
simulate network faults at home,"hi all, just need a sanity check on this one before i start adjusting my network. ive currently got 2x tplink archer vr1210v routers site a site b along with a tplink er605 vpn router site a at site a i will have three internet connections soon for failsafe copper line, satellite 4g due to this ive picked up an er605 for its dual wan capabilities. the config im thinking would be as follows site a archer vr1210v with copper fallback of 4g connected into wan2 of er605 satellite connection going into wan1 of er605 enabled as a fallback if wan2 loses connection this is the fastest connection hence why i want it primary im not hooking the usb 4g modem into the er605 as if wan1 fails it will only allow fallback to wan2 as far as i can see, im unable to select both wan2 usb as potential options. im thinking in this case if wan1 fails it falls back to wan2, if wan2 also has a fault the vr120v will fall itself back to 4g. from the er605 im then connecting up a 16 port switch to go to various endpoints along with a wifi access point. the vr1210 will have its wifi disabled and no actual clients connected to it. in this instance am i best disabling dhcp site a on the vr1210 as well as the satellite router and letting the er605 handle this instead or would that cause an issue with the er605 not being able to connect at all? both copper satellite routers would essentially be in modem mode passing the main workload onto the er605. also im looking to create an ipsec tunnel between both site a site b. site b is on a dynamic ip however i am going to enable the tp link dynamic dns service on there to overcome this. at site a the satellite connection has a static ip however the copper line does not, in this instance im guessing i setup the ipsec tunnel on the er605 rather than the vr1210 in order to access the network as otherwise ill end up connecting via the slower copper line connected to the vr1210? apologies if this is confusing, my brain is now fried. im fairly technical however my expertise is in building computers rather than networking! reason i want to connect both is as i run a jellyfin server at site a along with holding network folders, i would like these accessible easily to site b along with then allowing me to store another nas at site b to hold offsite backups. i currently do this via tailscale however i want to omit that if possible. thanks || i think you need to draw this out, because the connections are complicated. im going to try to answer, for site a, you are really only using the archer vr1210v as an dsl modem. im not familiar with tplinkarcher, but youll want to set it up as bridge vs a router. if this isnt possible, you are going to have trouble forwarding ipsec based packets though the vr1210 because it has an ipsec client built in that would intercept the inbound packets. you should see the er605 as the edge of your site a lan, with the vr1210 really only acting as a dsl modem dsl in, ethernet out. as for the wantunnel question, when i have multiple wan interfaces, i create a tunnel per interface, and use sdwan or load balancing to route traffic down the correct tunnel. im not sure if the er605 and vr1210 have this capability. in your situation, if the er605vr1210 supports it, i would create two tunnels on the er605 that both terminate to the same interface wan on the site b vr1210. hope that helps? tldr you might need different hardware"
